geom_line(size = 1)+
theme_bw()+
labs(x = "Time (min)", y = "Temperature (°C)", title= "Overnight Refrigeration at 7°C ")+
scale_color_discrete(name = "Temperature Profile")
ggplot(data = Df_RT_MT_Ref_2C_melted, aes(x = Time, y = value, color = variable))+
geom_line(size = 1)+
theme_bw()+
labs(x = "Time (min)", y = "Temperature (°C)", title= "Overnight Refrigeration at 2°C ")+
scale_color_discrete(name = "Temperature Profile")
Time_Temp_Df_Ref_2C<-Create_Temperature_Profile_days(First_Cond = "Room Temp",
Second_Cond = "Refrigeration",
First_Cond_Total_Time = 124,
Second_Cond_Total_Time = 1314,
First_Cond_Mean_Temperature = 22.1,
First_Cond_SD_Temperature = 0,#0.77,
Second_Cond_Mean_Temperature= 2,
Second_Cond_SD_Temperature = 0,#1.04,
Interval  =1,
Cycles = 5)
Temp_Milk_Vectors_Ref_2C<-predict_full_milk_temp(df = Time_Temp_Df_Ref_2C, Temp_Initial = 2)
Df_RT_MT_Ref_2C<-data.frame("RoomTemp" = Time_Temp_Df_Ref_2C$Rtemp,
"MilkTemp" = Temp_Milk_Vectors_Ref_2C,
"Time" = 1:length(Temp_Milk_Vectors_Ref_2C))
Df_RT_MT_Ref_2C_melted<-melt(Df_RT_MT_Ref_2C, id.vars = "Time")
Df_RT_MT_Ref_2C_melted$Condition = "Overnight Refrigeration 36°F (2°C)"
Df_RT_MT_Ref_2C_melted$Scenario = "Overnight Refrigeration Scenarios"
#Saving as CSV
write.csv(Df_RT_MT_Ref_2C, file = "Pedicted Time and Temp Profiles/Df_RT_MT_Ref_2C.csv")
Time_Temp_Df_Ref_7C<-Create_Temperature_Profile_days(First_Cond = "Room Temp",
Second_Cond = "Refrigeration",
First_Cond_Total_Time = 124,
Second_Cond_Total_Time = 1314,
First_Cond_Mean_Temperature = 22.1,
First_Cond_SD_Temperature = 0,#0.77,
Second_Cond_Mean_Temperature= 7,
Second_Cond_SD_Temperature = 0,#1.04,
Interval  =1,
Cycles = 5)
Temp_Milk_Vectors_Ref_7C<-predict_full_milk_temp(df = Time_Temp_Df_Ref_7C, Temp_Initial = 7)
Df_RT_MT_Ref_7C<-data.frame("RoomTemp" = Time_Temp_Df_Ref_7C$Rtemp,
"MilkTemp" = Temp_Milk_Vectors_Ref_7C,
"Time" = 1:length(Temp_Milk_Vectors_Ref_7C))
Df_RT_MT_Ref_7C_melted<-melt(Df_RT_MT_Ref_7C, id.vars = "Time")
Df_RT_MT_Ref_7C_melted$Condition = "Overnight Refrigeration 45°F (7°C)"
Df_RT_MT_Ref_7C_melted$Scenario = "Overnight Refrigeration Scenarios"
#Saving as CSV
write.csv(Df_RT_MT_Ref_7C, file = "Pedicted Time and Temp Profiles/Df_RT_MT_Ref_7C.csv")
Time_Temp_Df_Ref_4C<-Create_Temperature_Profile_days(First_Cond = "Room Temp",
Second_Cond = "Refrigeration",
First_Cond_Total_Time = 124,
Second_Cond_Total_Time = 1314,
First_Cond_Mean_Temperature = 22.1,
First_Cond_SD_Temperature = 0,#0.77,
Second_Cond_Mean_Temperature= 4,
Second_Cond_SD_Temperature = 0,#1.04,
Interval  =1,
Cycles = 5)
Temp_Milk_Vectors_Ref_4C<-predict_full_milk_temp(df = Time_Temp_Df_Ref_4C, Temp_Initial = 4)
Df_RT_MT_Ref_4C<-data.frame("RoomTemp" = Time_Temp_Df_Ref_4C$Rtemp,
"MilkTemp" = Temp_Milk_Vectors_Ref_4C,
"Time" = 1:length(Temp_Milk_Vectors_Ref_4C))
Df_RT_MT_Ref_4C_melted<-melt(Df_RT_MT_Ref_4C, id.vars = "Time")
Df_RT_MT_Ref_4C_melted$Condition = "Overnight Refrigeration 39°F (4°C)"
Df_RT_MT_Ref_4C_melted$Scenario = "Overnight Refrigeration Scenarios"
#Saving as CSV
write.csv(Df_RT_MT_Ref_4C, file = "Pedicted Time and Temp Profiles/Df_RT_MT_Ref_4C.csv")
Time_Temp_Df_s5b4<-Create_Temperature_Profile_days(First_Cond = "Room Temp",
Second_Cond = "Refrigeration",
First_Cond_Total_Time = 266,
Second_Cond_Total_Time = 1174,
First_Cond_Mean_Temperature = 22.1,
First_Cond_SD_Temperature = 0,#0.77,
Second_Cond_Mean_Temperature= 3.71,
Second_Cond_SD_Temperature = 0,#1.04,
Interval  =1,
Cycles = 5)
Temp_Milk_Vectors_s5b4<-predict_full_milk_temp(df = Time_Temp_Df_s5b4, Temp_Initial = 4)
Df_RT_MT_s5b4<-data.frame("RoomTemp" = Time_Temp_Df_s5b4$Rtemp,
"MilkTemp" = Temp_Milk_Vectors_s5b4,
"Time" = 1:length(Temp_Milk_Vectors_s5b4))
Df_RT_MT_s5b4_melted<-melt(Df_RT_MT_s5b4, id.vars = "Time")
Df_RT_MT_s5b4_melted$Condition = "5 Lunch (50 min) with 4 breaks (4 min)"
Df_RT_MT_s5b4_melted$Scenario = "Bell Schedule Scenarios"
#Saving as CSV
write.csv(Df_RT_MT_s5b4, file = "Pedicted Time and Temp Profiles/Df_RT_MT_s5b4.csv")
Time_Temp_Df_s4b3<-Create_Temperature_Profile_days(First_Cond = "Room Temp",
Second_Cond = "Refrigeration",
First_Cond_Total_Time = 221,
Second_Cond_Total_Time = 1219,
First_Cond_Mean_Temperature = 22.1,
First_Cond_SD_Temperature = 0,#0.77,
Second_Cond_Mean_Temperature= 3.71,
Second_Cond_SD_Temperature = 0,#1.04,
Interval  =1,
Cycles = 5)
Temp_Milk_Vectors_s4b3<-predict_full_milk_temp(df = Time_Temp_Df_s4b3, Temp_Initial = 4)
Df_RT_MT_s4b3<-data.frame("RoomTemp" = Time_Temp_Df_s4b3$Rtemp,
"MilkTemp" = Temp_Milk_Vectors_s4b3,
"Time" = 1:length(Temp_Milk_Vectors_s4b3))
Df_RT_MT_s4b3_melted<-melt(Df_RT_MT_s4b3, id.vars = "Time")
Df_RT_MT_s4b3_melted$Condition = "4 Lunch (50 min) with 3 breaks (7 min)"
Df_RT_MT_s4b3_melted$Scenario = "Bell Schedule Scenarios"
#Saving as CSV
write.csv(Df_RT_MT_s4b3, file = "Pedicted Time and Temp Profiles/Df_RT_MT_s4b3.csv")
Time_Temp_Df_s1b0<-Create_Temperature_Profile_days(First_Cond = "Room Temp",
Second_Cond = "Refrigeration",
First_Cond_Total_Time = 40,
Second_Cond_Total_Time = 1400,
First_Cond_Mean_Temperature = 22.1,
First_Cond_SD_Temperature = 0,#0.77,
Second_Cond_Mean_Temperature= 3.71,
Second_Cond_SD_Temperature = 0,#1.04,
Interval  =1,
Cycles = 5)
Temp_Milk_Vectors_s1b0<-predict_full_milk_temp(df = Time_Temp_Df_s1b0, Temp_Initial = 4)
Df_RT_MT_s1b0<-data.frame("RoomTemp" = Time_Temp_Df_s1b0$Rtemp,
"MilkTemp" = Temp_Milk_Vectors_s1b0,
"Time" = 1:length(Temp_Milk_Vectors_s1b0))
Df_RT_MT_s1b0_melted<-melt(Df_RT_MT_s1b0, id.vars = "Time")
Df_RT_MT_s1b0_melted$Condition = "1 Lunch (40 min) with 0 breaks"
Df_RT_MT_s1b0_melted$Scenario = "Bell Schedule Scenarios"
#Saving as CSV
write.csv(Df_RT_MT_s1b0, file = "Pedicted Time and Temp Profiles/Df_RT_MT_s1b0.csv")
Time_Temp_Df_s2b1<-Create_Temperature_Profile_days(First_Cond = "Room Temp",
Second_Cond = "Refrigeration",
First_Cond_Total_Time = 74,
Second_Cond_Total_Time = 1366,
First_Cond_Mean_Temperature = 22.1,
First_Cond_SD_Temperature = 0,#0.77,
Second_Cond_Mean_Temperature= 3.71,
Second_Cond_SD_Temperature = 0,#1.04,
Interval  =1,
Cycles = 5)
Temp_Milk_Vectors_s2b1<-predict_full_milk_temp(df = Time_Temp_Df_s2b1, Temp_Initial = 4)
Df_RT_MT_s2b1<-data.frame("RoomTemp" = Time_Temp_Df_s2b1$Rtemp,
"MilkTemp" = Temp_Milk_Vectors_s2b1,
"Time" = 1:length(Temp_Milk_Vectors_s2b1))
Df_RT_MT_s2b1_melted<-melt(Df_RT_MT_s2b1, id.vars = "Time")
Df_RT_MT_s2b1_melted$Condition = "2 Lunches (30 min) with 1 break (14 min)"
Df_RT_MT_s2b1_melted$Scenario = "Bell Schedule Scenarios"
#Saving as CSV
write.csv(Df_RT_MT_s2b1, file = "Pedicted Time and Temp Profiles/Df_RT_MT_s2b1.csv")
All_6_melted<-rbind(Df_RT_MT_RTB_melted,
Df_RT_MT_RT_melted,
Df_RT_MT_TIC_melted,
Df_RT_MT_TIP_melted,
Df_RT_MT_CI_melted,
Df_RT_MT_RTB_refB_melted,
Df_RT_MT_RTB_18C_melted,
Df_RT_MT_RTB_21C_melted,
Df_RT_MT_RTB_23C_melted,
Df_RT_MT_Ref_2C_melted,
Df_RT_MT_Ref_4C_melted,
Df_RT_MT_Ref_7C_melted,
Df_RT_MT_s5b4_melted,
Df_RT_MT_s4b3_melted,
Df_RT_MT_s2b1_melted,
Df_RT_MT_s1b0_melted
)
#All_6_melted$Condition<-str_replace(All_6_melted$Condition, pattern = "Room Temp B", replacement = "Baseline")
All_6_melted$Condition<-factor(All_6_melted$Condition, levels = c("Ambient Temperature 72°F (22.1°C)", "Refrigerated Tray", "Tray with Ice Packs", "Tray with Ice", "Cooler with Ice", "Ambient with Intermediate Refrigeration","Ambient Temperature 65°F (18.3° C)","Ambient Temperature 70°F (21.1° C)","Ambient Temperature 75°F (23.8° C)", "Overnight Refrigeration 36°F (2°C)","Overnight Refrigeration 39°F (4°C)","Overnight Refrigeration 45°F (7°C)","5 Lunch (50 min) with 4 breaks (4 min)","4 Lunch (50 min) with 3 breaks (7 min)","2 Lunches (30 min) with 1 break (14 min)","1 Lunch (40 min) with 0 breaks" ))
Max_RTB<-round(max(Df_RT_MT_RTB$MilkTemp),1)
Max_RT<-round(max(Df_RT_MT_RT$MilkTemp),1)
Max_TIC<-round(max(Df_RT_MT_TIC$MilkTemp),1)
Max_TIP<-round(max(Df_RT_MT_TIP$MilkTemp),1)
Max_CI<-round(max(Df_RT_MT_CI$MilkTemp),1)
Max_RTB_refB<-round(max(Df_RT_MT_RTB_refB$MilkTemp),1)
Max_RTB_18C<-round(max(Df_RT_MT_RTB_18C$MilkTemp),1)
Max_RTB_21C<-round(max(Df_RT_MT_RTB_21C$MilkTemp),1)
Max_RTB_23C<-round(max(Df_RT_MT_RTB_23C$MilkTemp),1)
Max_Ref_2C<-round(max(Df_RT_MT_Ref_2C$MilkTemp),1)
Max_Ref_4C<-round(max(Df_RT_MT_Ref_4C$MilkTemp),1)
Max_Ref_7C<-round(max(Df_RT_MT_Ref_7C$MilkTemp),1)
Max_s5b4<-round(max(Df_RT_MT_s5b4$MilkTemp),1)
Max_s4b3<-round(max(Df_RT_MT_s4b3$MilkTemp),1)
Max_s2b1<-round(max(Df_RT_MT_s2b1$MilkTemp),1)
Max_s1b0<-round(max(Df_RT_MT_s1b0$MilkTemp),1)
#RMSE and Text
dat_text <- data.frame(
label = c(paste("Milk Peak Temp:",Max_RTB,"°C"),
paste("Milk Peak Temp:",Max_RT,"°C"),
paste("Milk Peak Temp:",Max_TIC,"°C"),
paste("Milk Peak Temp:",Max_TIP,"°C"),
paste("Milk Peak Temp:",Max_CI,"°C"),
paste("Milk Peak Temp:",Max_RTB_refB,"°C"),
paste("Milk Peak Temp:",Max_RTB_18C,"°C"),
paste("Milk Peak Temp:",Max_RTB_21C,"°C"),
paste("Milk Peak Temp:",Max_RTB_23C,"°C"),
paste("Milk Peak Temp:",Max_Ref_2C,"°C"),
paste("Milk Peak Temp:",Max_Ref_4C,"°C"),
paste("Milk Peak Temp:",Max_Ref_7C,"°C"),
paste("Milk Peak Temp:",Max_s5b4,"°C"),
paste("Milk Peak Temp:",Max_s4b3,"°C"),
paste("Milk Peak Temp:",Max_s2b1,"°C"),
paste("Milk Peak Temp:",Max_s1b0,"°C")
),
Condition   = c("Ambient Temperature 72°F (22.1°C)", "Refrigerated Tray", "Tray with Ice Packs", "Tray with Ice", "Cooler with Ice", "Ambient with Intermediate Refrigeration","Ambient Temperature 65°F (18.3° C)","Ambient Temperature 70°F (21.1° C)","Ambient Temperature 75°F (23.8° C)", "Overnight Refrigeration 36°F (2°C)","Overnight Refrigeration 39°F (4°C)","Overnight Refrigeration 45°F (7°C)","5 Lunch (50 min) with 4 breaks (4 min)","4 Lunch (50 min) with 3 breaks (7 min)","2 Lunches (30 min) with 1 break (14 min)","1 Lunch (40 min) with 0 breaks"),
Scenario   = c("Condition Scenario", "Condition Scenario", "Condition Scenario", "Condition Scenario", "Condition Scenario", "Condition Scenario", "Ambient Temperature Scenarios","Ambient Temperature Scenarios","Ambient Temperature Scenarios","Overnight Refrigeration Scenarios","Overnight Refrigeration Scenarios","Overnight Refrigeration Scenarios","Bell Schedule Scenarios","Bell Schedule Scenarios","Bell Schedule Scenarios","Bell Schedule Scenarios"),
x     = c(5200, 5200, 5200,5200,5200, 5200, 5200,5200, 5200, 5200, 5200,5200, 5200,5200, 5200,5200),
y     = c(20, 20, 20,20,20,20,20, 20, 20,20,20,20,20,20,20,20)
)
All_6_melted$Scenario<-factor(All_6_melted$Scenario, levels = c("Condition Scenario","Ambient Temperature Scenarios","Overnight Refrigeration Scenarios","Bell Schedule Scenarios"))
dat_text$Scenario<-factor(dat_text$Scenario, levels = c("Condition Scenario","Ambient Temperature Scenarios","Overnight Refrigeration Scenarios","Bell Schedule Scenarios"))
ggplot(data = All_6_melted, aes(x = Time, y = value))+
geom_line(size = 0.6, aes(color = variable))+
theme_bw()+
labs(x = "Time (min)", y = "Temperature (°C)")+
scale_color_manual(name = "Temperature Profile", values = c("#00AFBB", "#FC4E07"))+
#scale_linetype_discrete(name = "Temperature Profile")+
facet_wrap(Scenario~Condition, ncol=3)+
theme(legend.position = "right")+
geom_text(data = dat_text, mapping = aes(x = x, y = y, label = label), size =3) +
theme(legend.position = "top",strip.text = element_text(face="bold"),strip.background = element_rect(fill="lightgrey"))
ggsave("All Temp Combined.png", height = 7, width = 9, dpi = 300)
#Standard Inputs
rho <-1.033 #kg/L
C <- 4.2 #kj/KgC°
V <- 0.236 #L
A <- 0.004275 #m2
get_h<-function(Neg_slope, rho = 1.033, C = 4.2 , V = 0.236, A = 0.004275){
neg_h =  ((Neg_slope*rho*C*V)/A)
return(- neg_h)
}
#Negative Slopes
Neg_Slope_RTB<-(-0.0124) #Room Temperature
Neg_Slope_Ref<-(-0.0088) #Refrigeration
Neg_Slope_RT<-(-0.0088) #Refrigerated Tray
Neg_Slope_TIC<-(-0.0057) #Tray with Ice
Neg_Slope_TIP<-(-0.0072) #Tray with Ice Packs
Neg_Slope_CI<-(-0.0008) #Cooler with Ice
#Getting the Heat Transfer Coefficients for each Temp
h_RTB = get_h(Neg_slope = Neg_Slope_RTB)
h_ref = get_h(Neg_slope = Neg_Slope_Ref)
h_RT = get_h(Neg_slope = Neg_Slope_RT)
h_TIC = get_h(Neg_slope = Neg_Slope_TIC)
h_TIP = get_h(Neg_slope = Neg_Slope_TIP)
h_CI = get_h(Neg_slope = Neg_Slope_CI)
#Function to get temperature as a constant time and temperature
get_temp<-function(h, To, Tinf, time,  A =0.004275,rho =1.033, C= 4.2, V = 0.236 ){
#Time in minutes
#Tinf = External Temp
#To = Initial temperature of the milk
# h = convection trans coefficient for that condition
return (exp(-(h*A/rho*C*V)*(time))*(To-Tinf)+Tinf)
}
#Constant outside temperature
predict_temp<-function(Initial_Temp, Room_temp, Total_min, h_condition){
#Returns a vector of temperatures
Total_Time_min = Total_min
Temp_Initial = Initial_Temp
T_inf = Room_temp
Temp_V<-c()
for (i in 1:Total_Time_min){
if (i == 1){
New_Temp = Temp_Initial
}else if (i == 2){
New_Temp = get_temp(h = h_condition, To = Temp_Initial, Tinf =  T_inf, time = 1)
}else{
New_Temp = get_temp(h = h_condition, To = New_Temp, Tinf =  T_inf, time = 1)
}
Temp_V<-c(Temp_V, New_Temp)
}
return (Temp_V)
}
predict_temp(Initial_Temp = 4.5,Room_temp = 22, Total_min = 42, h_condition = h_RTB)
#Predicting the temperature from a complete time and temperature profile.
predict_temp_fromProf<-function(Time_Temp_Prof, Initial_Temp,h_condition){
Time_Temp_Profile<-Time_Temp_Prof
Temp_Initial = Initial_Temp
Temp_V<-c()
for (i in 1:length(Time_Temp_Profile)){
T_inf<-Time_Temp_Profile[i]
if (i == 1){
New_Temp = Temp_Initial
}else if (i == 2){
New_Temp = get_temp(h = h_condition, To = Temp_Initial, Tinf =  T_inf, time = 1)
}else{
New_Temp = get_temp(h = h_condition, To = New_Temp, Tinf =  T_inf, time = 1)
}
Temp_V<-c(Temp_V, New_Temp)
}
return(Temp_V)
}
Time_Temp_Creation_Var<-function(Total_Time, Interval, Mean_Temperature, SD_Temperature){
Time_Temp_df<-data.frame("min"= seq(0,Total_Time,by = Interval),
"tempM"= rnorm(n =Total_Time+1, mean = Mean_Temperature, sd= SD_Temperature))
return (Time_Temp_df)
}
calc_bias = function(actual,predicted){
mean(actual - predicted)
}
Condition_Data<-read.csv("Bevier_Trial_Temps_External_50min.csv")
Condition_Data_InternalMilk<-read.csv("Bevier_Trial_Temps_Internal_50min.csv")
Predicted_RTB<-predict_temp_fromProf(Time_Temp_Prof =Condition_Data$Ambient.Temperature, Initial_Temp = Condition_Data_InternalMilk$Ambient.Temperature[1], h_condition = h_RTB)
Predicted_RT<-predict_temp_fromProf(Time_Temp_Prof =Condition_Data$Refrigerated.Tray, Initial_Temp = Condition_Data_InternalMilk$Refrigerated.Tray[1], h_condition = h_RT)
Predicted_TI<-predict_temp_fromProf(Time_Temp_Prof =Condition_Data$Tray.with.Ice, Initial_Temp = Condition_Data_InternalMilk$Tray.with.Ice[1], h_condition = h_TIC)
Predicted_TIP<-predict_temp_fromProf(Time_Temp_Prof =Condition_Data$Tray.with.Ice.Packs, Initial_Temp = Condition_Data_InternalMilk$Tray.with.Ice.Packs[1], h_condition = h_TIP)
Predicted_CI<-predict_temp_fromProf(Time_Temp_Prof =Condition_Data$Cooler.with.Ice, Initial_Temp = Condition_Data_InternalMilk$Cooler.with.Ice[1], h_condition = h_CI)
Predicted_ref<-predict_temp_fromProf(Time_Temp_Prof =Condition_Data$Refrigeration, Initial_Temp = Condition_Data_InternalMilk$Refrigeration[1], h_condition = h_ref)
calc_rmse(actual = Condition_Data_InternalMilk$Ambient.Temperature, predicted = Predicted_RTB[1:50])
calc_rmse(actual = Condition_Data_InternalMilk$Refrigerated.Tray, predicted = Predicted_RT[1:50])
calc_rmse(actual = Condition_Data_InternalMilk$Tray.with.Ice, predicted = Predicted_TI[1:50])
calc_rmse(actual = Condition_Data_InternalMilk$Tray.with.Ice.Packs, predicted = Predicted_TIP[1:50])
calc_rmse(actual = Condition_Data_InternalMilk$Cooler.with.Ice, predicted = Predicted_CI[1:50])
calc_rmse(actual = Condition_Data_InternalMilk$Refrigeration, predicted = Predicted_ref[1:50])
calc_bias(actual = Condition_Data_InternalMilk$Ambient.Temperature, predicted = Predicted_RTB[1:50])
calc_bias(actual = Condition_Data_InternalMilk$Ambient.Temperature, predicted = Predicted_RTB[1:50])
mean(actual - predicted)
Condition_Data_InternalMilk$Ambient.Temperature- Predicted_RTB[1:50]
calc_bias = function(actual,predicted){
mean(predicted - actual)
}
calc_bias(actual = Condition_Data_InternalMilk$Ambient.Temperature, predicted = Predicted_RTB[1:50])
calc_bias(actual = Condition_Data_InternalMilk$Ambient.Temperature, predicted = Predicted_RTB[1:50])
calc_bias(actual = Condition_Data_InternalMilk$Refrigerated.Tray, predicted = Predicted_RT[1:50])
calc_bias(actual = Condition_Data_InternalMilk$Tray.with.Ice, predicted = Predicted_TI[1:50])
calc_bias(actual = Condition_Data_InternalMilk$Tray.with.Ice.Packs, predicted = Predicted_TIP[1:50])
calc_bias(actual = Condition_Data_InternalMilk$Cooler.with.Ice, predicted = Predicted_CI[1:50])
calc_bias(actual = Condition_Data_InternalMilk$Refrigeration, predicted = Predicted_ref[1:50])
Condition_Data<-read.csv("Bevier_Trial_Temps_External_30min.csv")
Condition_Data_InternalMilk<-read.csv("Bevier_Trial_Temps_Internal_30min.csv")
Predicted_RTB<-predict_temp_fromProf(Time_Temp_Prof =Condition_Data$Ambient.Temperature, Initial_Temp = Condition_Data_InternalMilk$Ambient.Temperature[1], h_condition = h_RTB)
Predicted_RT<-predict_temp_fromProf(Time_Temp_Prof =Condition_Data$Refrigerated.Tray, Initial_Temp = Condition_Data_InternalMilk$Refrigerated.Tray[1], h_condition = h_RT)
Predicted_TI<-predict_temp_fromProf(Time_Temp_Prof =Condition_Data$Tray.with.Ice, Initial_Temp = Condition_Data_InternalMilk$Tray.with.Ice[1], h_condition = h_TIC)
Predicted_TIP<-predict_temp_fromProf(Time_Temp_Prof =Condition_Data$Tray.with.Ice.Packs, Initial_Temp = Condition_Data_InternalMilk$Tray.with.Ice.Packs[1], h_condition = h_TIP)
Predicted_CI<-predict_temp_fromProf(Time_Temp_Prof =Condition_Data$Cooler.with.Ice, Initial_Temp = Condition_Data_InternalMilk$Cooler.with.Ice[1], h_condition = h_CI)
Predicted_ref<-predict_temp_fromProf(Time_Temp_Prof =Condition_Data$Refrigeration, Initial_Temp = Condition_Data_InternalMilk$Refrigeration[1], h_condition = h_ref)
calc_rmse(actual = Condition_Data_InternalMilk$Ambient.Temperature, predicted = Predicted_RTB)
calc_rmse(actual = Condition_Data_InternalMilk$Refrigerated.Tray, predicted = Predicted_RT)
calc_rmse(actual = Condition_Data_InternalMilk$Tray.with.Ice, predicted = Predicted_TI)
calc_rmse(actual = Condition_Data_InternalMilk$Tray.with.Ice.Packs, predicted = Predicted_TIP)
calc_rmse(actual = Condition_Data_InternalMilk$Cooler.with.Ice, predicted = Predicted_CI)
calc_rmse(actual = Condition_Data_InternalMilk$Refrigeration, predicted = Predicted_ref)
calc_bias(actual = Condition_Data_InternalMilk$Ambient.Temperature, predicted = Predicted_RTB)
calc_bias(actual = Condition_Data_InternalMilk$Refrigerated.Tray, predicted = Predicted_RT)
calc_bias(actual = Condition_Data_InternalMilk$Tray.with.Ice, predicted = Predicted_TI)
calc_bias(actual = Condition_Data_InternalMilk$Tray.with.Ice.Packs, predicted = Predicted_TIP)
calc_bias(actual = Condition_Data_InternalMilk$Cooler.with.Ice, predicted = Predicted_CI)
calc_bias(actual = Condition_Data_InternalMilk$Refrigeration, predicted = Predicted_ref)
#RMSE and Text
dat_text <- data.frame(
label = c("RMSE: 0.72", "RMSE: 0.06", "RMSE:0.50", "RMSE: 0.31", "RMSE: 0.12", "RMSE: 0.19"),
variable   = c("Ambient Temperature","Cooler with Ice","Tray with Ice","Tray with Ice Packs","Refrigerated Tray","Refrigeration"),
x     = c(30, 30, 30,30,30,20),
y     = c(4, 2.15, 3,3,4,14)
)
dat_text_h <- data.frame(
label = c("h: 2.97", "h: 0.19", "h: 1.37", "h: 1.72", "h: 2.11", "h = 2.11"  ),
variable   = c("Ambient Temperature","Cooler with Ice","Tray with Ice","Tray with Ice Packs","Refrigerated Tray","Refrigeration"),
x     = c(30, 30, 30,30,30, 20),
y     = c(3, 2.08, 2.5,2.4,3.4, 13.5)
)
dat_text$variable<-factor(dat_text$variable, levels= c("Ambient Temperature","Cooler with Ice","Tray with Ice","Tray with Ice Packs","Refrigerated Tray","Refrigeration"))
dat_text_h$variable<-factor(dat_text_h$variable, levels= c("Ambient Temperature","Cooler with Ice","Tray with Ice","Tray with Ice Packs","Refrigerated Tray","Refrigeration"))
Predicted_vs_Observed$variable<-factor(Predicted_vs_Observed$variable, levels= c("Ambient Temperature","Cooler with Ice","Tray with Ice","Tray with Ice Packs","Refrigerated Tray","Refrigeration"))
ggplot(Predicted_vs_Observed, aes(x = Time))+
#geom_point(aes(y = value, color = type))+
geom_line(aes(y = value, color = type, linetype = type), size=1)+
facet_wrap(~variable, scales = "free_y")+
theme_bw()+
labs(y = "Temperature (°C)", x = "Time (min)", color = "Observed vs Predicted",linetype = "Observed vs Predicted", title = "Fitted Data, 50 minutes")+
geom_text(data    = dat_text,
mapping = aes(x = x, y = y, label = label), size =3.5)+
geom_text(data    = dat_text_h,
mapping = aes(x = x, y = y, label = label), size =3.5)+
scale_color_manual(values = c("#00AFBB", "#FC4E07"))
calc_rmse=function(actual, predicted) {
sqrt(mean((actual - predicted) ^ 2))
}
calc_bias = function(actual,predicted){
mean(predicted - actual)
}
Condition_Data<-read.csv("Bevier_Trial_Temps_External_50min.csv")
Condition_Data_InternalMilk<-read.csv("Bevier_Trial_Temps_Internal_50min.csv")
Predicted_RTB<-predict_temp_fromProf(Time_Temp_Prof =Condition_Data$Ambient.Temperature, Initial_Temp = Condition_Data_InternalMilk$Ambient.Temperature[1], h_condition = h_RTB)
Predicted_RT<-predict_temp_fromProf(Time_Temp_Prof =Condition_Data$Refrigerated.Tray, Initial_Temp = Condition_Data_InternalMilk$Refrigerated.Tray[1], h_condition = h_RT)
Predicted_TI<-predict_temp_fromProf(Time_Temp_Prof =Condition_Data$Tray.with.Ice, Initial_Temp = Condition_Data_InternalMilk$Tray.with.Ice[1], h_condition = h_TIC)
Predicted_TIP<-predict_temp_fromProf(Time_Temp_Prof =Condition_Data$Tray.with.Ice.Packs, Initial_Temp = Condition_Data_InternalMilk$Tray.with.Ice.Packs[1], h_condition = h_TIP)
Predicted_CI<-predict_temp_fromProf(Time_Temp_Prof =Condition_Data$Cooler.with.Ice, Initial_Temp = Condition_Data_InternalMilk$Cooler.with.Ice[1], h_condition = h_CI)
Predicted_ref<-predict_temp_fromProf(Time_Temp_Prof =Condition_Data$Refrigeration, Initial_Temp = Condition_Data_InternalMilk$Refrigeration[1], h_condition = h_ref)
calc_rmse(actual = Condition_Data_InternalMilk$Ambient.Temperature, predicted = Predicted_RTB[1:50])
calc_rmse(actual = Condition_Data_InternalMilk$Refrigerated.Tray, predicted = Predicted_RT[1:50])
calc_rmse(actual = Condition_Data_InternalMilk$Tray.with.Ice, predicted = Predicted_TI[1:50])
calc_rmse(actual = Condition_Data_InternalMilk$Tray.with.Ice.Packs, predicted = Predicted_TIP[1:50])
calc_rmse(actual = Condition_Data_InternalMilk$Cooler.with.Ice, predicted = Predicted_CI[1:50])
calc_rmse(actual = Condition_Data_InternalMilk$Refrigeration, predicted = Predicted_ref[1:50])
calc_bias(actual = Condition_Data_InternalMilk$Ambient.Temperature, predicted = Predicted_RTB[1:50])
calc_bias(actual = Condition_Data_InternalMilk$Refrigerated.Tray, predicted = Predicted_RT[1:50])
calc_bias(actual = Condition_Data_InternalMilk$Tray.with.Ice, predicted = Predicted_TI[1:50])
calc_bias(actual = Condition_Data_InternalMilk$Tray.with.Ice.Packs, predicted = Predicted_TIP[1:50])
calc_bias(actual = Condition_Data_InternalMilk$Cooler.with.Ice, predicted = Predicted_CI[1:50])
calc_bias(actual = Condition_Data_InternalMilk$Refrigeration, predicted = Predicted_ref[1:50])
PredictionDf<-data.frame("Time" = c(1:50),
"Ambient.Temperature" = Predicted_RTB,
"Cooler.with.Ice" = Predicted_CI,
"Tray.with.Ice"= Predicted_TI,
"Tray.with.Ice.Packs"= Predicted_TIP,
"Refrigerated.Tray" = Predicted_RT,
"Refrigeration" = Predicted_ref)
library(reshape2)
library(ggplot2)
Internal_DF<-reshape2::melt(Condition_Data_InternalMilk, id.vars = "Time")
Internal_DF$type<-"Observed"
Predicted_DF<-reshape2::melt(PredictionDf, id.vars = "Time")
Predicted_DF$type<-"Predicted"
Predicted_vs_Observed<-rbind(Internal_DF,Predicted_DF)
Predicted_vs_Observed$variable<-as.character(Predicted_vs_Observed$variable)
Predicted_vs_Observed$variable[Predicted_vs_Observed$variable == "Ambient.Temperature"] <- "Ambient Temperature"
Predicted_vs_Observed$variable[Predicted_vs_Observed$variable == "Cooler.with.Ice"] <- "Cooler with Ice"
Predicted_vs_Observed$variable[Predicted_vs_Observed$variable == "Tray.with.Ice"] <- "Tray with Ice"
Predicted_vs_Observed$variable[Predicted_vs_Observed$variable == "Tray.with.Ice.Packs"] <- "Tray with Ice Packs"
Predicted_vs_Observed$variable[Predicted_vs_Observed$variable == "Refrigerated.Tray"] <- "Refrigerated Tray"
#RMSE and Text
dat_text <- data.frame(
label = c("RMSE: 0.72", "RMSE: 0.06", "RMSE:0.50", "RMSE: 0.31", "RMSE: 0.12", "RMSE: 0.19"),
variable   = c("Ambient Temperature","Cooler with Ice","Tray with Ice","Tray with Ice Packs","Refrigerated Tray","Refrigeration"),
x     = c(30, 30, 30,30,30,20),
y     = c(4, 2.15, 3,3,4,14)
)
dat_text_h <- data.frame(
label = c("h: 2.97", "h: 0.19", "h: 1.37", "h: 1.72", "h: 2.11", "h = 2.11"  ),
variable   = c("Ambient Temperature","Cooler with Ice","Tray with Ice","Tray with Ice Packs","Refrigerated Tray","Refrigeration"),
x     = c(30, 30, 30,30,30, 20),
y     = c(3, 2.08, 2.5,2.4,3.4, 13.5)
)
dat_text$variable<-factor(dat_text$variable, levels= c("Ambient Temperature","Cooler with Ice","Tray with Ice","Tray with Ice Packs","Refrigerated Tray","Refrigeration"))
dat_text_h$variable<-factor(dat_text_h$variable, levels= c("Ambient Temperature","Cooler with Ice","Tray with Ice","Tray with Ice Packs","Refrigerated Tray","Refrigeration"))
Predicted_vs_Observed$variable<-factor(Predicted_vs_Observed$variable, levels= c("Ambient Temperature","Cooler with Ice","Tray with Ice","Tray with Ice Packs","Refrigerated Tray","Refrigeration"))
ggplot(Predicted_vs_Observed, aes(x = Time))+
#geom_point(aes(y = value, color = type))+
geom_line(aes(y = value, color = type, linetype = type), size=1)+
facet_wrap(~variable, scales = "free_y")+
theme_bw()+
labs(y = "Temperature (°C)", x = "Time (min)", color = "Observed vs Predicted",linetype = "Observed vs Predicted", title = "Fitted Data, 50 minutes")+
geom_text(data    = dat_text,
mapping = aes(x = x, y = y, label = label), size =3.5)+
geom_text(data    = dat_text_h,
mapping = aes(x = x, y = y, label = label), size =3.5)+
scale_color_manual(values = c("#00AFBB", "#FC4E07"))
ggplot(Predicted_vs_Observed, aes(x = Time))+
#geom_point(aes(y = value, color = type))+
geom_line(aes(y = value, color = type, linetype = type), size=1)+
facet_wrap(~variable)+
theme_bw()+
labs(y = "Temperature (°C)", x = "Time (min)", color = "Observed vs Predicted",linetype = "Observed vs Predicted", title = "Fitted Data, 50 minutes")+
geom_text(data    = dat_text,
mapping = aes(x = x, y = y, label = label), size =3.5)+
geom_text(data    = dat_text_h,
mapping = aes(x = x, y = y, label = label), size =3.5)+
scale_color_manual(values = c("#00AFBB", "#FC4E07"))
Condition_Data<-read.csv("Bevier_Trial_Temps_External_30min.csv")
Condition_Data_InternalMilk<-read.csv("Bevier_Trial_Temps_Internal_30min.csv")
Predicted_RTB<-predict_temp_fromProf(Time_Temp_Prof =Condition_Data$Ambient.Temperature, Initial_Temp = Condition_Data_InternalMilk$Ambient.Temperature[1], h_condition = h_RTB)
Predicted_RT<-predict_temp_fromProf(Time_Temp_Prof =Condition_Data$Refrigerated.Tray, Initial_Temp = Condition_Data_InternalMilk$Refrigerated.Tray[1], h_condition = h_RT)
Predicted_TI<-predict_temp_fromProf(Time_Temp_Prof =Condition_Data$Tray.with.Ice, Initial_Temp = Condition_Data_InternalMilk$Tray.with.Ice[1], h_condition = h_TIC)
Predicted_TIP<-predict_temp_fromProf(Time_Temp_Prof =Condition_Data$Tray.with.Ice.Packs, Initial_Temp = Condition_Data_InternalMilk$Tray.with.Ice.Packs[1], h_condition = h_TIP)
Predicted_CI<-predict_temp_fromProf(Time_Temp_Prof =Condition_Data$Cooler.with.Ice, Initial_Temp = Condition_Data_InternalMilk$Cooler.with.Ice[1], h_condition = h_CI)
Predicted_ref<-predict_temp_fromProf(Time_Temp_Prof =Condition_Data$Refrigeration, Initial_Temp = Condition_Data_InternalMilk$Refrigeration[1], h_condition = h_ref)
calc_rmse(actual = Condition_Data_InternalMilk$Ambient.Temperature, predicted = Predicted_RTB)
calc_rmse(actual = Condition_Data_InternalMilk$Refrigerated.Tray, predicted = Predicted_RT)
calc_rmse(actual = Condition_Data_InternalMilk$Tray.with.Ice, predicted = Predicted_TI)
calc_rmse(actual = Condition_Data_InternalMilk$Tray.with.Ice.Packs, predicted = Predicted_TIP)
calc_rmse(actual = Condition_Data_InternalMilk$Cooler.with.Ice, predicted = Predicted_CI)
calc_rmse(actual = Condition_Data_InternalMilk$Refrigeration, predicted = Predicted_ref)
calc_bias(actual = Condition_Data_InternalMilk$Ambient.Temperature, predicted = Predicted_RTB)
calc_bias(actual = Condition_Data_InternalMilk$Refrigerated.Tray, predicted = Predicted_RT)
calc_bias(actual = Condition_Data_InternalMilk$Tray.with.Ice, predicted = Predicted_TI)
calc_bias(actual = Condition_Data_InternalMilk$Tray.with.Ice.Packs, predicted = Predicted_TIP)
calc_bias(actual = Condition_Data_InternalMilk$Cooler.with.Ice, predicted = Predicted_CI)
calc_bias(actual = Condition_Data_InternalMilk$Refrigeration, predicted = Predicted_ref)
PredictionDf<-data.frame("Time" = c(1:30),
"Ambient.Temperature" = Predicted_RTB,
"Cooler.with.Ice" = Predicted_CI,
"Tray.with.Ice"= Predicted_TI,
"Tray.with.Ice.Packs"= Predicted_TIP,
"Refrigerated.Tray" = Predicted_RT,
"Refrigeration" = Predicted_ref)
library(reshape2)
library(ggplot2)
Internal_DF<-reshape2::melt(Condition_Data_InternalMilk, id.vars = "Time")
Internal_DF$type<-"Observed"
Predicted_DF<-reshape2::melt(PredictionDf, id.vars = "Time")
Predicted_DF$type<-"Predicted"
Predicted_vs_Observed<-rbind(Internal_DF,Predicted_DF)
Predicted_vs_Observed$variable<-as.character(Predicted_vs_Observed$variable)
Predicted_vs_Observed$variable[Predicted_vs_Observed$variable == "Ambient.Temperature"] <- "Ambient Temperature"
Predicted_vs_Observed$variable[Predicted_vs_Observed$variable == "Cooler.with.Ice"] <- "Cooler with Ice"
Predicted_vs_Observed$variable[Predicted_vs_Observed$variable == "Tray.with.Ice"] <- "Tray with Ice"
Predicted_vs_Observed$variable[Predicted_vs_Observed$variable == "Tray.with.Ice.Packs"] <- "Tray with Ice Packs"
Predicted_vs_Observed$variable[Predicted_vs_Observed$variable == "Refrigerated.Tray"] <- "Refrigerated Tray"
#RMSE and Text
dat_text <- data.frame(
label = c("RMSE: 0.43", "RMSE: 0.06", "RMSE:1.15", "RMSE: 0.64", "RMSE: 0.41", "RMSE: 1.25"),
variable   = c("Ambient Temperature","Cooler with Ice","Tray with Ice","Tray with Ice Packs","Refrigerated Tray","Refrigeration"),
x     = c(20,20,20,20,20,10),
y     = c(3, 2.55, 3,2.5,2.5,18)
)
dat_text$variable<-factor(dat_text$variable, levels= c("Ambient Temperature","Cooler with Ice","Tray with Ice","Tray with Ice Packs","Refrigerated Tray","Refrigeration"))
Predicted_vs_Observed$variable<-factor(Predicted_vs_Observed$variable, levels= c("Ambient Temperature","Cooler with Ice","Tray with Ice","Tray with Ice Packs","Refrigerated Tray","Refrigeration"))
ggplot(Predicted_vs_Observed, aes(x = Time))+
geom_line(aes(y = value, color = type, linetype = type), size=1)+
facet_wrap(~variable)+
theme_bw()+
labs(y = "Temperature (°C)", x = "Time (min)", color = "Observed vs Predicted",linetype = "Observed vs Predicted", title = "Testing Data, 30 minutes")+
geom_text(data    = dat_text,
mapping = aes(x = x, y = y, label = label), size =3.5)+
scale_color_manual(values = c("#00AFBB", "#FC4E07"))
#Install
devtools::install_github("zeehio/facetscales")
install.packages("devtools")
#Install
devtools::install_github("zeehio/facetscales")
