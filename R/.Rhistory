Milkdf[3]<-Output_Milk[2]
Milkdf[2]<-Output_Milk[1]+Milkdf[2]
if(Milkdf[2]>Pop_Max){
Milkdf[2]<-Pop_Max
}
return(Milkdf)
}
Temperature_Static<- rlaplace(1,m=4.06,s=2.31)
while (Temperature_Static > 15 | Temperature_Static < -1) {
Temperature_Static<- rlaplace(1,m=4.06,s=2.31)
}
Time_Temp_df<-data.frame("min"= seq(1,1060*5))
Time_Temp_df$means = 4.06
Milkdf<-data.frame("MilkID" = seq(0,100),"SpoilageCon" =NA, "LagCon" = 0, "Species" = NA)
Milkdf$Species<-9#sample(SpeciesDF$ST,size = length(Milkdf$Species), prob = SpeciesDF$Prev, replace = T)
Milkdf$SpoilageCon<-2.1#rtruncnorm(n = length(Milkdf$SpoilageCon),b = 3, mean =0.3817872, sd=1.108859)
Milkdf$SpoilageConIn<-Milkdf$SpoilageCon
mean(Milkdf$SpoilageConIn)
N_Days = 1
for (i in 1:N_Days){
Milkdf<-Spoilage_Function(Milkdf,Time_Temp_df)
}
mean(Milkdf$SpoilageCon)
hist(Milkdf$SpoilageCon)
Milkdf<-data.frame("MilkID" = seq(0,1000),"SpoilageCon" =NA, "LagCon" = 0, "Species" = NA)
Milkdf$Species<-sample(SpeciesDF$ST,size = length(Milkdf$Species), prob = SpeciesDF$Prev, replace = T)
Milkdf$SpoilageCon<-rtruncnorm(n = length(Milkdf$SpoilageCon),b = 3, mean =0.3817872, sd=1.108859)
Milkdf$SpoilageConIn<-Milkdf$SpoilageCon
mean(Milkdf$SpoilageCon)
Midfbu<-Milkdf
OvernightSto_C %>%
ggplot(aes(x = min, y = means))+
geom_point()
library(tidyverse)
library(ExtDist)
library(jmuOutlier)
library(truncnorm)
library(reshape2)
#Function for growth and lag phase
new_growth_rate<-function(newTemp, oldMu,oldTemp = 6, T0 = -4.15){
newMu<-((newTemp-T0)/(oldTemp-T0))* oldMu
return (newMu)
}
#Calculation of the new lag time.
new_lag_time <- function (newTemp, oldLag, oldTemp = 6, T0 = -4.15) {
numerator <- oldTemp -T0
denom <- newTemp - T0
newLag <- ( (numerator / denom)^2) * oldLag
return(newLag)
}
#Not in use, function to create a data frame based on interval and initial and final temperature
Time_Temp_Creation<-function(Total_Time, Interval, Initial_Temperature, Final_Temperature){
Time_Temp_df<-data.frame("min"= seq(0,Total_Time,by = Interval),
"tempM"  = seq(Initial_Temperature,Final_Temperature, by = ((Final_Temperature - Initial_Temperature)/(length(seq(0,Total_Time,by = Interval)) - 1) )))
}
Time_Temp_Creation_Var<-function(Total_Time, Interval, Mean_Temperature, SD_Temperature){
Time_Temp_df<-data.frame("min"= seq(0,Total_Time,by = Interval),
"tempM"= rnorm(n =Total_Time+1, mean = Mean_Temperature, sd= SD_Temperature))
return (Time_Temp_df)
}
#This function calculates thee growth based on a time and temperature profile for 1 specific milk with R100084 P Paoae
Func_Growth_LagCon<-function(In_Lag_Consumed, Time_Temp_df,Interval){
#In_Lag_Consumed= Total lag time consumed
#Time_Temp_df = dataframe with time and temperature conditions
#Interval = time interval in the time_temp_df in hrs.
Total_Lag_Consumed = In_Lag_Consumed
Total_Growth = 0
old_lag = 0
NMax = 8.14
old_mumax = 0.083508
for (i in 1:nrow(Time_Temp_df)){
if (Total_Lag_Consumed <1 && old_lag!=0){
Lag_t_interval<-new_lag_time(newTemp = Time_Temp_df$tempM[i], oldLag = old_lag)
Lag_Consumed<-Interval/Lag_t_interval
Total_Lag_Consumed<-Total_Lag_Consumed+Lag_Consumed
Growth = 0
} else if (Total_Lag_Consumed>=1 | old_lag == 0){
Growth = ((new_growth_rate(newTemp = Time_Temp_df$tempM[i], oldMu = old_mumax))/2.303)*0.684 #Converted log10 from log ln
Total_Growth = Total_Growth + (Growth*Interval)
}
}
return(c(Total_Growth,Total_Lag_Consumed))
}
#Buchanan spoilage function
Spoilage_Function<-function(Milkdf,Time_Temp_df){
for(i in 1:nrow(Milkdf)){
In_Lag_Consumed<-Milkdf$LagCon[i] #selecting lag for specific milk
ST_Iter<-Milkdf$Species[i] #selecting the ST of interest
Pop_Max<-look_for_st(st= ST_Iter,par_of_int = "Nmax") #Population max for given ST
Interval <- 1/60 #Interval in hours. means 0.01666 hours. maybe need is an input?
#this function provides two outputs, the total growth, and the new updated lag phase consumed.
Output_Milk<-Func_Growth_LagCon(In_Lag_Consumed = In_Lag_Consumed ,Time_Temp_df = Time_Temp_df,ST_Iter = ST_Iter,Interval = Interval)
#updating the total lag consumed
Milkdf$LagCon[i]<-Output_Milk[2]
#Updating the spoilage contamination of milk
Milkdf$SpoilageCon[i]<-Output_Milk[1]+Milkdf$SpoilageCon[i]
#Updating, that is Pop max is reached, then the current population is at population max.
if(Milkdf$SpoilageCon[i]>Pop_Max){
Milkdf$SpoilageCon[i]<-Pop_Max
}
}
#Returns the updated milk data frame
return(Milkdf)
}
#Buchanan spoilage function
Spoilage_Function_Single_Milk<-function(Cont, Pop_Max, Time_Temp_df, Interval =1/60){
Lag_Consumed = 0
#this function provides two outputs, the total growth, and the new updated lag phase consumed.
Output_Milk<-Func_Growth_LagCon(In_Lag_Consumed = Lag_Consumed ,Time_Temp_df = Time_Temp_df,Interval = Interval)
Lag_Consumed = Output_Milk[2]
Cont<-Output_Milk[1]+Cont
if( Cont>Pop_Max){
Cont = Pop_Max
}
return (Cont)
}
Time_Temp_Df<-Time_Temp_Creation_Var(Total_Time = 96*60, Interval = 1,Mean_Temperature = 4.36,SD_Temperature = 0.1591)
Spoilage_Function_Single_Milk(Cont = 2.44, Pop_Max =8.14, Time_Temp_df = Time_Temp_Df, Interval =1/60)
Dec_Day1<-read.csv("Dec_Day1_Temps.csv")
Func_Growth_LagCon(In_Lag_Consumed =0, Time_Temp_df= Dec_Day1,Interval =1/60)
Time_Temp_Profile<-read_csv("5Days-Adjusted-Temp-2hr-Cycles.csv")
Time_Temp_Profile
#Function for growth and lag phase
new_growth_rate<-function(newTemp, oldMu,oldTemp = 6, T0 = -4.15){
newMu<-((newTemp-T0)/(oldTemp-T0))* oldMu
return (newMu)
}
#Calculation of the new lag time.
new_lag_time <- function (newTemp, oldLag, oldTemp = 6, T0 = -4.15) {
numerator <- oldTemp -T0
denom <- newTemp - T0
newLag <- ( (numerator / denom)^2) * oldLag
return(newLag)
}
#Not in use, function to create a data frame based on interval and initial and final temperature
Time_Temp_Creation<-function(Total_Time, Interval, Initial_Temperature, Final_Temperature){
Time_Temp_df<-data.frame("min"= seq(0,Total_Time,by = Interval),
"tempM"  = seq(Initial_Temperature,Final_Temperature, by = ((Final_Temperature - Initial_Temperature)/(length(seq(0,Total_Time,by = Interval)) - 1) )))
}
Time_Temp_Creation_Var<-function(Total_Time, Interval, Mean_Temperature, SD_Temperature){
Time_Temp_df<-data.frame("min"= seq(0,Total_Time,by = Interval),
"tempM"= rnorm(n =Total_Time+1, mean = Mean_Temperature, sd= SD_Temperature))
return (Time_Temp_df)
}
#This function calculates thee growth based on a time and temperature profile for 1 specific milk with R100084 P Paoae
Func_Growth_LagCon<-function(In_Lag_Consumed, Time_Temp_df,Interval){
#In_Lag_Consumed= Total lag time consumed
#Time_Temp_df = dataframe with time and temperature conditions
#Interval = time interval in the time_temp_df in hrs.
Total_Lag_Consumed = In_Lag_Consumed
Total_Growth = 0
old_lag = 0
NMax = 8.14
old_mumax = 0.083508
Growth_V = c()
for (i in 1:nrow(Time_Temp_df)){
if (Total_Lag_Consumed <1 && old_lag!=0){
Lag_t_interval<-new_lag_time(newTemp = Time_Temp_df$tempM[i], oldLag = old_lag)
Lag_Consumed<-Interval/Lag_t_interval
Total_Lag_Consumed<-Total_Lag_Consumed+Lag_Consumed
Growth = 0
} else if (Total_Lag_Consumed>=1 | old_lag == 0){
Growth = ((new_growth_rate(newTemp = Time_Temp_df$tempM[i], oldMu = old_mumax))/2.303)* 1.3209#0.684 #Converted log10 from log ln
Total_Growth = Total_Growth + (Growth*Interval)
}
Growth_V = c(Growth_V,Total_Growth)
#print(length(Growth_V))
}
return(list(Total_Growth,Total_Lag_Consumed,Growth_V))
}
Output_Milk<-Func_Growth_LagCon(In_Lag_Consumed = 0 ,Time_Temp_df = Time_Temp_Profile,Interval = 1/60)
#This function calculates thee growth based on a time and temperature profile for 1 specific milk with R100084 P Paoae
Func_Growth_LagCon<-function(In_Lag_Consumed, Time_Temp_df,Interval){
#In_Lag_Consumed= Total lag time consumed
#Time_Temp_df = dataframe with time and temperature conditions
#Interval = time interval in the time_temp_df in hrs.
Total_Lag_Consumed = In_Lag_Consumed
Total_Growth = 0
old_lag = 0
NMax = 8.14
old_mumax = 0.083508
Growth_V = c()
for (i in 1:nrow(Time_Temp_df)){
if (Total_Lag_Consumed <1 && old_lag!=0){
Lag_t_interval<-new_lag_time(newTemp = Time_Temp_df$tempM[i], oldLag = old_lag)
Lag_Consumed<-Interval/Lag_t_interval
Total_Lag_Consumed<-Total_Lag_Consumed+Lag_Consumed
Growth = 0
} else if (Total_Lag_Consumed>=1 | old_lag == 0){
Growth = ((new_growth_rate(newTemp = Time_Temp_df$tempM[i], oldMu = old_mumax))/2.303)* 1.3209#0.684 #Converted log10 from log ln
Total_Growth = Total_Growth + (Growth*Interval)
}
Growth_V = c(Growth_V,Total_Growth)
#print(length(Growth_V))
}
return(list(Total_Growth,Total_Lag_Consumed,Growth_V))
}
Output_Milk<-Func_Growth_LagCon(In_Lag_Consumed = 0 ,Time_Temp_df = Time_Temp_Profile,Interval = 1/60)
Time_Temp_Profile<-read_csv("5Days-Adjusted-Temp-2hr-Cycles.csv")
Time_Temp_Profile
Time_Temp_Profile<-read_csv("5Days-Adjusted-Temp-2hr-Cycles.csv")
Output_Milk<-Func_Growth_LagCon(In_Lag_Consumed = 0 ,Time_Temp_df = Time_Temp_Profile,Interval = 1/60)
Output_Milk
Output_Milk[[3]]
Changes_Over_Time<-Output_Milk[[3]]
#Setting Working Directory-------------------------------------
#setwd("C:/Users/gareyes3/Documents/GitHub/Share-Table-Milk/R")
#setwd("G:/Share Table QMRA/Share-Table-QMRA/R")
#setwd(getSrcDirectory()[1])
setwd(dirname(rstudioapi::getActiveDocumentContext()$path)) #Set working directory to the path of document
#Opening Libary and Inputs-------------------------------------
source("Util_Library.R")
source("Functions_Full_Analysis.R")
Time_Temp_Profile<-read_csv("5Days-Adjusted-Temp-2hr-Cycles.csv")
#Function for growth and lag phase
new_growth_rate<-function(newTemp, oldMu,oldTemp = 6, T0 = -4.15){
newMu<-((newTemp-T0)/(oldTemp-T0))* oldMu
return (newMu)
}
#Calculation of the new lag time.
new_lag_time <- function (newTemp, oldLag, oldTemp = 6, T0 = -4.15) {
numerator <- oldTemp -T0
denom <- newTemp - T0
newLag <- ( (numerator / denom)^2) * oldLag
return(newLag)
}
#Not in use, function to create a data frame based on interval and initial and final temperature
Time_Temp_Creation<-function(Total_Time, Interval, Initial_Temperature, Final_Temperature){
Time_Temp_df<-data.frame("min"= seq(0,Total_Time,by = Interval),
"tempM"  = seq(Initial_Temperature,Final_Temperature, by = ((Final_Temperature - Initial_Temperature)/(length(seq(0,Total_Time,by = Interval)) - 1) )))
}
Time_Temp_Creation_Var<-function(Total_Time, Interval, Mean_Temperature, SD_Temperature){
Time_Temp_df<-data.frame("min"= seq(0,Total_Time,by = Interval),
"tempM"= rnorm(n =Total_Time+1, mean = Mean_Temperature, sd= SD_Temperature))
return (Time_Temp_df)
}
#This function calculates thee growth based on a time and temperature profile for 1 specific milk with R100084 P Paoae
Func_Growth_LagCon<-function(In_Lag_Consumed, Time_Temp_df,Interval){
#In_Lag_Consumed= Total lag time consumed
#Time_Temp_df = dataframe with time and temperature conditions
#Interval = time interval in the time_temp_df in hrs.
Total_Lag_Consumed = In_Lag_Consumed
Total_Growth = 0
old_lag = 0
NMax = 8.14
old_mumax = 0.083508
Growth_V = c()
for (i in 1:nrow(Time_Temp_df)){
if (Total_Lag_Consumed <1 && old_lag!=0){
Lag_t_interval<-new_lag_time(newTemp = Time_Temp_df$tempM[i], oldLag = old_lag)
Lag_Consumed<-Interval/Lag_t_interval
Total_Lag_Consumed<-Total_Lag_Consumed+Lag_Consumed
Growth = 0
} else if (Total_Lag_Consumed>=1 | old_lag == 0){
Growth = ((new_growth_rate(newTemp = Time_Temp_df$tempM[i], oldMu = old_mumax))/2.303)* 1.3209#0.684 #Converted log10 from log ln
Total_Growth = Total_Growth + (Growth*Interval)
}
Growth_V = c(Growth_V,Total_Growth)
#print(length(Growth_V))
}
return(list(Total_Growth,Total_Lag_Consumed,Growth_V))
}
Output_Milk<-Func_Growth_LagCon(In_Lag_Consumed = 0 ,Time_Temp_df = Time_Temp_Profile,Interval = 1/60)
Changes_Over_Time<-Output_Milk[[3]]
#Running Loop First:-------------------------------------
start_time<-Sys.time()
source("Main_Loops2.R")
#Running Loop First:-------------------------------------
start_time<-Sys.time()
source("Main_Loops2.R")
knitr::opts_chunk$set(echo = TRUE)
Detection_Rates_High_DPT<-read.csv(file = "Detection_Rates_High_DPT_LOC.csv")
Detection_Rates_High_DPT<-Detection_Rates_High_DPT[,-1]
Detection_Rates_High_DPT %>%
ggplot(aes(x = Cluster, y = Drates))+
geom_point(fill = "skyblue", color = "black")+
geom_line()+
labs(x = "Contamination Cluster", y = "Detection Rate")+
theme_bw()
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(scales)
library(reshape2)
library(tidyverse)
Detection_Rates_High_DPT<-read.csv(file = "Detection_Rates_High_DPT_LOC.csv")
Detection_Rates_High_DPT<-Detection_Rates_High_DPT[,-1]
Detection_Rates_High_DPT %>%
ggplot(aes(x = Cluster, y = Drates))+
geom_point(fill = "skyblue", color = "black")+
geom_line()+
labs(x = "Contamination Cluster", y = "Detection Rate")+
theme_bw()
Detection_Rates_High_DPT %>%
ggplot(aes(x = Cluster, y = Drates))+
geom_point(fill = "skyblue", color = "black")+
geom_col()+
labs(x = "Contamination Cluster", y = "Detection Rate")+
theme_bw()
Detection_Rates_High_DPT %>%
ggplot(aes(x = Cluster, y = Drates))+
geom_col(fill = "skyblue", color = "black")+
geom_line()+
labs(x = "Contamination Cluster", y = "Detection Rate")+
theme_bw()
Detection_Rates_High_DPT$Cluster<-as.factor(Detection_Rates_High_DPT$Cluster)
Detection_Rates_High_DPT %>%
ggplot(aes(x = Cluster, y = Drates))+
geom_col(fill = "skyblue", color = "black")+
geom_line()+
labs(x = "Contamination Cluster", y = "Detection Rate")+
theme_bw()
Detection_Rates_High_DPT<-read.csv(file = "Detection_Rates_High_DPT_LOC.csv")
Detection_Rates_High_DPT<-Detection_Rates_High_DPT[,-1]
Detection_Rates_High_DPT$Cluster<-round(Detection_Rates_High_DPT$Cluster,1)
Detection_Rates_High_DPT$Cluster<-as.factor(Detection_Rates_High_DPT$Cluster)
Detection_Rates_High_DPT %>%
ggplot(aes(x = Cluster, y = Drates))+
geom_col(fill = "skyblue", color = "black")+
geom_line()+
labs(x = "Contamination Cluster", y = "Detection Rate")+
theme_bw()
Detection_Rates_High_DPT<-read.csv(file = "Detection_Rates_High_DPT_LOC.csv")
Detection_Rates_High_DPT<-Detection_Rates_High_DPT[,-1]
Detection_Rates_High_DPT$Cluster<-round(Detection_Rates_High_DPT$Cluster,1)
Detection_Rates_High_DPT$Cluster<-as.factor(Detection_Rates_High_DPT$Cluster)
Detection_Rates_High_DPT %>%
ggplot(aes(x = Cluster, y = Drates))+
geom_col(fill = "skyblue", color = "black")+
geom_line()+
labs(x = "Contamination Spread", y = "Detection Rate")+
theme_bw()
Detection_Rates_High_DPT<-read.csv(file = "Detection_Rates_High_FPT_LOC.csv")
Detection_Rates_High_DPT<-Detection_Rates_High_DPT[,-1]
Detection_Rates_High_DPT$Cluster<-round(Detection_Rates_High_DPT$Cluster,1)
Detection_Rates_High_DPT$Cluster<-as.factor(Detection_Rates_High_DPT$Cluster)
PS_High %>%
group_by(variable) %>%
summarise(mean = mean(value), q25 = quantile(value, 0.05), q975 = quantile(value, 0.95)) %>%
ggplot(aes(x = variable, y = mean, ymin = q25, ymax = q975))+
geom_col(fill = "skyblue", color = "black")+
#coord_flip()+
labs(x = "Contamination Cluster", y = "Detection Rate")+
theme_bw()
Detection_Rates_High_DPT %>%
ggplot(aes(x = Cluster, y = Drates))+
geom_col(fill = "skyblue", color = "black")+
geom_line()+
labs(x = "Contamination Spread", y = "Detection Rate")+
theme_bw()
Detection_Rates_High_DPT<-read.csv(file = "Detection_Rates_High_FPT_LOC.csv")
Detection_Rates_High_DPT<-Detection_Rates_High_DPT[,-1]
Detection_Rates_High_DPT$Cluster<-round(Detection_Rates_High_DPT$Cluster,1)
Detection_Rates_High_DPT$Cluster<-as.factor(Detection_Rates_High_DPT$Cluster)
Detection_Rates_High_DPT %>%
ggplot(aes(x = Cluster, y = Drates))+
geom_col(fill = "skyblue", color = "black")+
geom_line()+
labs(x = "Contamination Spread", y = "Detection Rate")+
theme_bw()
Detection_Rates_High_DPT<-read.csv(file = "Detection_Rates_High_DPT_LOC.csv")
Detection_Rates_High_DPT<-Detection_Rates_High_DPT[,-1]
Detection_Rates_High_DPT$Cluster<-round(Detection_Rates_High_DPT$Cluster,1)
Detection_Rates_High_DPT$Cluster<-as.factor(Detection_Rates_High_DPT$Cluster)
Detection_Rates_High_DPT %>%
ggplot(aes(x = Cluster, y = Drates))+
geom_col(fill = "skyblue", color = "black")+
geom_line()+
labs(x = "Contamination Spread", y = "Detection Rate")+
theme_bw()
Detection_Rates_High_DPT<-read.csv(file = "Detection_Rates_High_DPT_LOC2.csv")
Detection_Rates_High_DPT<-read.csv(file = "Detection_Rates_High_FPT_LOC2.csv")
Detection_Rates_High_DPT<-Detection_Rates_High_DPT[,-1]
Detection_Rates_High_DPT$Cluster<-round(Detection_Rates_High_DPT$Cluster,1)
Detection_Rates_High_DPT$Cluster<-as.factor(Detection_Rates_High_DPT$Cluster)
Detection_Rates_High_DPT %>%
ggplot(aes(x = Cluster, y = Drates))+
geom_col(fill = "skyblue", color = "black")+
geom_line()+
labs(x = "Contamination Spread", y = "Detection Rate")+
theme_bw()
Detection_Rates_High_DPT
Detection_Rates_High_DPT %>%
ggplot(aes(x = Cluster, y = Drates))+
geom_col(fill = "skyblue", color = "black")+
geom_line(aes(y = assay_rate))+
labs(x = "Contamination Spread", y = "Detection Rate")+
theme_bw()
Detection_Rates_High_DPT %>%
ggplot(aes(x = Cluster, y = Drates))+
geom_col(fill = "skyblue", color = "black")+
geom_line(aes(y = assay_rate), color = "black")+
labs(x = "Contamination Spread", y = "Detection Rate")+
theme_bw()
Detection_Rates_High_DPT %>%
ggplot()+
geom_col(aes(x = Cluster, y = Drates),fill = "skyblue", color = "black")+
geom_line(aes(y = assay_rate), color = "black")+
labs(x = "Contamination Spread", y = "Detection Rate")+
theme_bw()
Detection_Rates_High_DPT %>%
ggplot()+
geom_col(aes(x = Cluster, y = Drates),fill = "skyblue", color = "black")+
geom_line(aes(x= Cluster, y = assay_rate), color = "black")+
labs(x = "Contamination Spread", y = "Detection Rate")+
theme_bw()
View(Detection_Rates_High_DPT)
Detection_Rates_High_DPT %>%
ggplot()+
geom_col(aes(x = Cluster, y = Drates),fill = "skyblue", color = "black")+
geom_line(aes(x= Cluster, y = assay_rate), color = "black")+
labs(x = "Contamination Spread", y = "Detection Rate")+
theme_bw()
Detection_Rates_High_DPT %>%
ggplot()+
geom_col(aes(x = Cluster, y = Drates),fill = "skyblue", color = "black")+
geom_line(aes(x= Cluster, y = assay_rate, group = Cluster), color = "black")+
labs(x = "Contamination Spread", y = "Detection Rate")+
theme_bw()
Detection_Rates_High_DPT %>%
ggplot()+
geom_col(aes(x = Cluster, y = Drates),fill = "skyblue", color = "black")+
geom_point(aes(x= Cluster, y = assay_rate), color = "black")+
labs(x = "Contamination Spread", y = "Detection Rate")+
theme_bw()
Detection_Rates_High_DPT
Detection_Rates_High_DPT %>%
ggplot()+
geom_col(aes(x = Cluster, y = Drates),fill = "skyblue", color = "black")+
geom_point(aes(x= Cluster, y = assay_rate), color = "black")+
geom_point(aes(x = Cluster, y = samp_rate))
Detection_Rates_High_DPT %>%
ggplot()+
geom_col(aes(x = Cluster, y = Drates),fill = "skyblue", color = "black")+
geom_point(aes(x= Cluster, y = assay_rate), color = "black")+
geom_point(aes(x = Cluster, y = samp_rate)+)
Detection_Rates_High_DPT %>%
ggplot()+
geom_col(aes(x = Cluster, y = Drates),fill = "skyblue", color = "black")+
geom_point(aes(x= Cluster, y = assay_rate), color = "black")+
geom_point(aes(x = Cluster, y = samp_rate))+
labs(x = "Contamination Spread", y = "Detection Rate")+
theme_bw()
Detection_Rates_High_DPT %>%
ggplot()+
geom_col(aes(x = Cluster, y = Drates),fill = "skyblue", color = "black")+
geom_point(aes(x= Cluster, y = assay_rate), color = "black")+
geom_point(aes(x = Cluster, y = samp_rate), color = "blue")+
labs(x = "Contamination Spread", y = "Detection Rate")+
theme_bw()
Detection_Rates_High_DPT %>%
ggplot()+
geom_col(aes(x = Cluster, y = Drates),fill = "skyblue", color = "black")+
geom_point(aes(x= Cluster, y = assay_rate), color = "black")+
geom_point(aes(x = Cluster, y = samp_rate), color = "coral")+
labs(x = "Contamination Spread", y = "Detection Rate")+
theme_bw()
Detection_Rates_High_DPT %>%
ggplot()+
geom_col(aes(x = Cluster, y = Drates),fill = "skyblue", color = "black")+
geom_point(aes(x= Cluster, y = assay_rate), color = "black", shape = 21)+
geom_point(aes(x = Cluster, y = samp_rate), color = "coral")+
labs(x = "Contamination Spread", y = "Detection Rate")+
theme_bw()
Detection_Rates_High_DPT %>%
ggplot()+
geom_col(aes(x = Cluster, y = Drates),fill = "skyblue", color = "black")+
geom_point(aes(x= Cluster, y = assay_rate), color = "black", fill = "black", shape = 21)+
geom_point(aes(x = Cluster, y = samp_rate), color = "coral")+
labs(x = "Contamination Spread", y = "Detection Rate")+
theme_bw()
Detection_Rates_High_DPT %>%
ggplot()+
geom_col(aes(x = Cluster, y = Drates),fill = "skyblue", color = "black")+
geom_point(aes(x= Cluster, y = assay_rate), color = "black", fill = "black", shape = 21)+
geom_point(aes(x = Cluster, y = samp_rate), color = "coral",ill = "black", shape = 21)+
labs(x = "Contamination Spread", y = "Detection Rate")+
theme_bw()
Detection_Rates_High_DPT %>%
ggplot()+
geom_col(aes(x = Cluster, y = Drates),fill = "skyblue", color = "black")+
geom_point(aes(x= Cluster, y = assay_rate), color = "black", fill = "black", shape = 21)+
geom_point(aes(x = Cluster, y = samp_rate), color = "coral",fill = "black", shape = 21)+
labs(x = "Contamination Spread", y = "Detection Rate")+
theme_bw()
Detection_Rates_High_DPT %>%
ggplot()+
geom_col(aes(x = Cluster, y = Drates),fill = "skyblue", color = "black")+
geom_point(aes(x= Cluster, y = assay_rate), color = "black", fill = "black", shape = 21)+
geom_point(aes(x = Cluster, y = samp_rate), fill = "coral",color = "black", shape = 21)+
labs(x = "Contamination Spread", y = "Detection Rate")+
theme_bw()
Detection_Rates_High_DPT %>%
ggplot()+
geom_col(aes(x = Cluster, y = Drates),fill = "skyblue", color = "black")+
geom_point(aes(x= Cluster, y = assay_rate), color = "black", fill = "black", shape = 21, size =2)+
geom_point(aes(x = Cluster, y = samp_rate), fill = "coral",color = "black", shape = 21)+
labs(x = "Contamination Spread", y = "Detection Rate")+
theme_bw()
Detection_Rates_High_DPT %>%
ggplot()+
geom_col(aes(x = Cluster, y = Drates),fill = "skyblue", color = "black")+
geom_point(aes(x= Cluster, y = assay_rate), color = "black", fill = "black", shape = 21, size =2)+
geom_point(aes(x = Cluster, y = samp_rate), fill = "coral",color = "black", shape = 21, size ==2)+
labs(x = "Contamination Spread", y = "Detection Rate")+
theme_bw()
Detection_Rates_High_DPT %>%
ggplot()+
geom_col(aes(x = Cluster, y = Drates),fill = "skyblue", color = "black")+
geom_point(aes(x= Cluster, y = assay_rate), color = "black", fill = "black", shape = 21, size =2)+
geom_point(aes(x = Cluster, y = samp_rate), fill = "coral",color = "black", shape = 21, size =2)+
labs(x = "Contamination Spread", y = "Detection Rate")+
theme_bw()
