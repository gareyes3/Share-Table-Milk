fmaf_raw_plot = spec_plot(data = X_raw_long, class = "FM_class", yaxis = "Intensity (Normalized)")
plot(fmaf_raw_plot)
log10(0.022)
log10(0.0022)
#Exactly 2 accidents in 1 week
dpois(x = 2, lambda = 1.4)
#Exactly 3 accidents in 1 week
dpois(x = 3, lambda = 1.4)
#At most 2 accidents next week
ppois(x=2, lambda =1.4)
#At most 2 accidents next week
ppois(q=2, lambda =1.4)
#at leasr 2 accidents in next 2 weeks.
1-ppois(q=2, lambda = 2.8)
#at leasr 2 accidents in next 2 weeks.
1-ppois(q=1, lambda = 2.8)
#next accident will not occur for 3 days
dpois(x = 0, lambda = 0.6)
#more than 1 hour for 5th bus to arrive alpha =5 , theta= 3 lambda = 1/3
dgamma?
#more than 1 hour for 5th bus to arrive alpha =5 , theta= 3 lambda = 1/3
?dgamma
#more than 1 hour for 5th bus to arrive alpha =5 , theta= 3 lambda = 1/3
pgamma(q= 1, shape = 5, scale = 3)
#more than 1 hour for 5th bus to arrive alpha =5 , theta= 3 lambda = 1/3
pgamma(q= 1, shape = 5, scale = 1/3)
#more than 1 hour for 5th bus to arrive alpha =5 , theta= 3 lambda = 1/3
1pgamma(q= 1, shape = 5, scale = 1/3)
#more than 1 hour for 5th bus to arrive alpha =5 , theta= 3 lambda = 1/3
1-pgamma(q= 1, shape = 5, scale = 1/3)
ppois(q = 3,4)
ppois(q = 4,lambda = 3)
#more the 5th bus arrives in the second hour, thetal = 3, labda = 1/3
ppois(q = 4,lambda = 6)-ppois(q = 4,lambda = 9)
pgamma(q=3,shape =5, scale  = 1/3)-pgamma(q=2,shape =5, scale  = 1/3)
ppois(q= 6,lambda = 10.5)-ppois(6,14)
pgamma(4,7,1/3.5)-pgamma(3,7,1/3.5)
pgamma(4,7,3.5)-pgamma(3,7,3.5)
pgamma(4,7,3.5)-pgamma(3,7,3.5)
100000*454
grams<- 100000*454
50000/ grams
50000*(5/(10000*454))
1-exp(-0.05506608)
runif(1,0,1)
runif(1,0,1)
runif(1,0,1)
runif(1,0,1)
runif(1,0,1)
runif(1,0,1)
runif(1,0,1)
runif(1,0,1) < P_Detection
P_Detection <- (1-exp(-0.05506608))
runif(1,0,1) < P_Detection
runif(1,0,1) < P_Detection
runif(1,0,1) < P_Detection
runif(1,0,1) < P_Detection
runif(1,0,1) < P_Detection
runif(1,0,1) < P_Detection
for (i in 1:60){
runif(1,0,1) < P_Detection
}
outputs = list()
for (i in 1:60){
A_R<-runif(1,0,1) < P_Detection
outputs(outputs,A_R)
}
outputs <- list()
for (i in 1:60){
A_R<-runif(1,0,1) < P_Detection
outputs(outputs,A_R)
}
outputs <- list()
for (i in 1:60){
A_R<-runif(1,0,1) < P_Detection
outputs<-(outputs,A_R)
}
A_R<-runif(1,0,1) < P_Detection
outputs<-(outputs,A_R)
outputs <- list()
for (i in 1:60){
A_R<-runif(1,0,1) < P_Detection
outputs<-list(outputs,A_R)
}
View(outputs)
View(outputs)
outputs <- list()
for (i in 1:60){
A_R<-runif(1,0,1) < P_Detection
print(A_R)
}
temp = 25
7544*temp^-3.11
75440*temp^-3.11
(7544*temp)^-3.11
temp = 25
(7544*temp)^-3.11
7544*temp^-3.11
growthrate = (0.023*(temo-1.20))^2
growthrate = (0.023*(temp-1.20))^2
(growthrate*(time))2.303
time= 10
(growthrate*(time))2.303
(growthrate*(time))/2.303
temp = 20
time= 10
7544*temp^-3.11
growthrate = (0.023*(temp-1.20))^2
(growthrate*(time))/2.303
pchisq(24,30)
pgamma(6.5,5,1/2.5)
pgamma(6.5,5,2.5)
?chisq
dchisq(x = 0.95,30)
qchisq(0.05,30)
qchisq(0.05,35)
qchisq(0.95,35)
1-pchis1(7.6,6)
1-pchisq(7.6,6)
1-pchisq(8.4,6)
knitr::opts_chunk$set(echo = TRUE)
setwd("C:/Users/gareyes3/Downloads")
library(tidyverse)
library(ggplot2)
library(reshape2)
Ghana <- read.csv("Ghana_sorted_toxinAF.csv", header = TRUE)
data1 <- data.frame (x= Ghana$Sample_ID, y1 = Ghana$AF_ppb_accept, y2 = Ghana$AF_ppb_reject)
datalist<-data1$x
print(datalist)
setDT(data1)
Ghana2 <- read.csv("Ghana_sorted_toxinFM.csv", header = TRUE)
Ghana2 <- read.csv("Ghana_sorted_toxinFM.csv", header = TRUE)
Ghana2 <- read.csv("Ghana_sorted_toxinFM.csv", header = TRUE)
Ghana2 <- read.csv("Ghana_sorted_toxinFM.csv", header = TRUE)
setwd("C:/Users/gareyes3/Downloads")
library(tidyverse)
library(ggplot2)
library(reshape2)
Ghana2 <- read.csv("Ghana_sorted_toxinFM.csv", header = TRUE)
Ghana2 <- read.csv("Ghana_sorted_toxinFM.csv", header = TRUE)
Ghana2 <- read.csv("Ghana_sorted_toxinFM.csv", header = TRUE)
Ghana2 <- read.csv("Ghana_sorted_toxinFM.csv", header = TRUE)
data2 <- data.frame (x= Ghana2$Sample_ID, y1 = Ghana2$FM_ppm_accept, y2 = Ghana2$FM_ppm_reject)
datalist2<-data2$x
data_long2 <- melt(data2, id = "x")
head(data_long2)
ggp2 <- ggplot(data_long2,  aes(x = factor(x, level = datalist2), y = value, color = variable, shape = variable, show.legend = F))+  geom_point()+  labs(x = "Sample ID", y = "Fumonisin Level (ppm)", fill = "Fumonisin Type" ) + scale_color_manual( values = c("blue", "red"), name = "Fumonisin Measurement",labels = c( "Accept Stream", "Reject Stream")) + theme(axis.text.x = element_text(vjust = 0.5,angle = 45), text = element_text(size = 13)) + scale_shape_manual(values = c(16,17,4), name = "Fumonisin Measurement",labels = c( "Accept Stream", "Reject Stream")) + geom_hline(yintercept=2, linetype="dashed", color = "tomato2")
ggp2
data2 <- data.frame (x= Ghana2$Sample_ID, y1 = Ghana2$FM_ppm_accept, y2 = Ghana2$FM_ppm_reject)
datalist2<-data2$x
data_long2 <- melt(data2, id = "x")
head(data_long2)
ggp2 <- ggplot(data_long2,  aes(x = factor(x, level = datalist2), y = value, color = variable, shape = variable, show.legend = F))+  geom_point()+  labs(x = "Sample ID", y = "Fumonisin Level (ppm)", fill = "Fumonisin Type" ) + scale_color_manual( values = c("blue", "red"), name = "Fumonisin Measurement",labels = c( "Accept Stream", "Reject Stream")) + theme(axis.text.x = element_text(vjust = 0.5,angle = 45), text = element_text(size = 13)) + scale_shape_manual(values = c(16,17,4), name = "Fumonisin Measurement",labels = c( "Accept Stream", "Reject Stream")) + geom_hline(yintercept=2, linetype="dashed", color = "tomato2")
ggp2
knitr::opts_chunk$set(echo = TRUE)
setwd("C:/Users/gareyes3/Dpwnloads")
setwd("C:/Users/gareyes3/Downloads")
library(tidyverse)
library(ggplot2)
library(reshape2)
library(data.table)
Ghana2 <- read.csv("Ghana_sorted_toxinFM.csv", header = TRUE)
data2 <- data.frame (x= Ghana2$Sample_ID, y1 = Ghana2$FM_ppm_accept, y2 = Ghana2$FM_ppm_reject)
datalist2<-data2$x
data_long2 <- melt(data2, id = "x")
head(data_long2)
ggp2 <- ggplot(data_long2,  aes(x = factor(x, level = datalist2), y = value, color = variable, shape = variable, show.legend = F))+  geom_point()+  labs(x = "Sample ID", y = "Fumonisin Level (ppm)", fill = "Fumonisin Type" ) + scale_color_manual( values = c("blue", "red"), name = "Fumonisin Measurement",labels = c( "Accept Stream", "Reject Stream")) + theme(axis.text.x = element_text(vjust = 0.5,angle = 45), text = element_text(size = 13)) + scale_shape_manual(values = c(16,17,4), name = "Fumonisin Measurement",labels = c( "Accept Stream", "Reject Stream")) + geom_hline(yintercept=2, linetype="dashed", color = "tomato2")
ggp2
View(data_long2)
View(data_long2)
View(data_long2)
View(data_long2)
ggp2 <- ggplot(data_long2,  aes(x = factor(x, level = datalist2), y = value, color = variable, shape = variable, show.legend = F))+
geom_point()+
geom_line(aes(group = variable))+
labs(x = "Sample ID", y = "Fumonisin Level (ppm)", fill = "Fumonisin Type" ) +
scale_color_manual( values = c("blue", "red"), name = "Fumonisin Measurement",labels = c( "Accept Stream", "Reject Stream")) + theme(axis.text.x = element_text(vjust = 0.5,angle = 45), text = element_text(size = 13)) +
scale_shape_manual(values = c(16,17,4), name = "Fumonisin Measurement",labels = c( "Accept Stream", "Reject Stream")) + geom_hline(yintercept=2, linetype="dashed", color = "tomato2")
ggp2
View(data_long2)
ggp2 <- ggplot(data_long2,  aes(x = factor(x, level = datalist2), y = value, color = variable, shape = variable, show.legend = F))+
geom_point()+
geom_line(aes(group = value))+
labs(x = "Sample ID", y = "Fumonisin Level (ppm)", fill = "Fumonisin Type" ) +
scale_color_manual( values = c("blue", "red"), name = "Fumonisin Measurement",labels = c( "Accept Stream", "Reject Stream")) + theme(axis.text.x = element_text(vjust = 0.5,angle = 45), text = element_text(size = 13)) +
scale_shape_manual(values = c(16,17,4), name = "Fumonisin Measurement",labels = c( "Accept Stream", "Reject Stream")) + geom_hline(yintercept=2, linetype="dashed", color = "tomato2")
ggp2
View(data_long2)
ggp2 <- ggplot(data_long2,  aes(x = factor(x, level = datalist2), y = value, color = variable, shape = variable, show.legend = F))+
geom_point()+
geom_line(aes(group = x))+
labs(x = "Sample ID", y = "Fumonisin Level (ppm)", fill = "Fumonisin Type" ) +
scale_color_manual( values = c("blue", "red"), name = "Fumonisin Measurement",labels = c( "Accept Stream", "Reject Stream")) + theme(axis.text.x = element_text(vjust = 0.5,angle = 45), text = element_text(size = 13)) +
scale_shape_manual(values = c(16,17,4), name = "Fumonisin Measurement",labels = c( "Accept Stream", "Reject Stream")) + geom_hline(yintercept=2, linetype="dashed", color = "tomato2")
ggp2
ggp2 <- ggplot(data_long2,  aes(x = factor(x, level = datalist2), y = value, color = variable, shape = variable, show.legend = F))+
geom_point()+
geom_line(aes(group = x), color = "black")+
labs(x = "Sample ID", y = "Fumonisin Level (ppm)", fill = "Fumonisin Type" ) +
scale_color_manual( values = c("blue", "red"), name = "Fumonisin Measurement",labels = c( "Accept Stream", "Reject Stream")) + theme(axis.text.x = element_text(vjust = 0.5,angle = 45), text = element_text(size = 13)) +
scale_shape_manual(values = c(16,17,4), name = "Fumonisin Measurement",labels = c( "Accept Stream", "Reject Stream")) + geom_hline(yintercept=2, linetype="dashed", color = "tomato2")
ggp2
ggp2 <- ggplot(data_long2,  aes(x = factor(x, level = datalist2), y = value, color = variable, shape = variable, show.legend = F))+
geom_point()+
geom_line(arrow = arrow(length=unit(0.30,"cm"), ends="first", type = "closed"))+
#geom_line(aes(group = x), color = "black")+
labs(x = "Sample ID", y = "Fumonisin Level (ppm)", fill = "Fumonisin Type" ) +
scale_color_manual( values = c("blue", "red"), name = "Fumonisin Measurement",labels = c( "Accept Stream", "Reject Stream")) + theme(axis.text.x = element_text(vjust = 0.5,angle = 45), text = element_text(size = 13)) +
scale_shape_manual(values = c(16,17,4), name = "Fumonisin Measurement",labels = c( "Accept Stream", "Reject Stream")) + geom_hline(yintercept=2, linetype="dashed", color = "tomato2")
ggp2
ggp2 <- ggplot(data_long2,  aes(x = factor(x, level = datalist2), y = value, color = variable, shape = variable, show.legend = F))+
geom_point()+
geom_line(aes(group = x), color = "black",arrow = arrow(length=unit(0.30,"cm"), ends="first", type = "closed"))+
labs(x = "Sample ID", y = "Fumonisin Level (ppm)", fill = "Fumonisin Type" ) +
scale_color_manual( values = c("blue", "red"), name = "Fumonisin Measurement",labels = c( "Accept Stream", "Reject Stream")) + theme(axis.text.x = element_text(vjust = 0.5,angle = 45), text = element_text(size = 13)) +
scale_shape_manual(values = c(16,17,4), name = "Fumonisin Measurement",labels = c( "Accept Stream", "Reject Stream")) + geom_hline(yintercept=2, linetype="dashed", color = "tomato2")
ggp2
ggp2 <- ggplot(data_long2,  aes(x = factor(x, level = datalist2), y = value, color = variable, shape = variable, show.legend = F))+
geom_point()+
geom_line(aes(group = x), color = "black",arrow = arrow(length=unit(0.2,"cm"), ends="first", type = "closed"))+
labs(x = "Sample ID", y = "Fumonisin Level (ppm)", fill = "Fumonisin Type" ) +
scale_color_manual( values = c("blue", "red"), name = "Fumonisin Measurement",labels = c( "Accept Stream", "Reject Stream")) + theme(axis.text.x = element_text(vjust = 0.5,angle = 45), text = element_text(size = 13)) +
scale_shape_manual(values = c(16,17,4), name = "Fumonisin Measurement",labels = c( "Accept Stream", "Reject Stream")) + geom_hline(yintercept=2, linetype="dashed", color = "tomato2")
ggp2
ggp2 <- ggplot(data_long2,  aes(x = factor(x, level = datalist2), y = value, color = variable, shape = variable, show.legend = F))+
geom_point()+
geom_line(aes(group = x), color = "black",arrow = arrow(length=unit(0.2,"cm")))+
labs(x = "Sample ID", y = "Fumonisin Level (ppm)", fill = "Fumonisin Type" ) +
scale_color_manual( values = c("blue", "red"), name = "Fumonisin Measurement",labels = c( "Accept Stream", "Reject Stream")) + theme(axis.text.x = element_text(vjust = 0.5,angle = 45), text = element_text(size = 13)) +
scale_shape_manual(values = c(16,17,4), name = "Fumonisin Measurement",labels = c( "Accept Stream", "Reject Stream")) + geom_hline(yintercept=2, linetype="dashed", color = "tomato2")
ggp2
ggp2 <- ggplot(data_long2,  aes(x = factor(x, level = datalist2), y = value, color = variable, shape = variable, show.legend = F))+
geom_point()+
geom_line(aes(group = x), color = "black",arrow = arrow(length=unit(0.2,"cm"), ends="first", type = "closed"))+
labs(x = "Sample ID", y = "Fumonisin Level (ppm)", fill = "Fumonisin Type" ) +
scale_color_manual( values = c("blue", "red"), name = "Fumonisin Measurement",labels = c( "Accept Stream", "Reject Stream")) + theme(axis.text.x = element_text(vjust = 0.5,angle = 45), text = element_text(size = 13)) +
scale_shape_manual(values = c(16,17,4), name = "Fumonisin Measurement",labels = c( "Accept Stream", "Reject Stream")) + geom_hline(yintercept=2, linetype="dashed", color = "tomato2")
ggp2
ggp2 <- ggplot(data_long2,  aes(x = factor(x, level = datalist2), y = value, color = variable, shape = variable, show.legend = F))+
geom_point()+
geom_line(aes(group = x), color = "black",arrow = arrow(length=unit(0.2,"cm"), type = "closed"))+
labs(x = "Sample ID", y = "Fumonisin Level (ppm)", fill = "Fumonisin Type" ) +
scale_color_manual( values = c("blue", "red"), name = "Fumonisin Measurement",labels = c( "Accept Stream", "Reject Stream")) + theme(axis.text.x = element_text(vjust = 0.5,angle = 45), text = element_text(size = 13)) +
scale_shape_manual(values = c(16,17,4), name = "Fumonisin Measurement",labels = c( "Accept Stream", "Reject Stream")) + geom_hline(yintercept=2, linetype="dashed", color = "tomato2")
ggp2
log10(8.3)
10^8.3
10^8.3/10^6.6
0.0006*100
Is_Student_ill<-0 #reseting student ill
Cont_Student<- ifelse(runif(1)<Pr_Student_iC,do.call(Func_ICont_Student,Inputs_ICont_Student),0)
if (Cont_Student>0){
#Student_Cont_Count<-(Student_Cont_Count+1) do not need
Vector_Contaminations_In<-c(Vector_Contaminations_In, Cont_Student)
if (Hawashing_Station == 1){
LogRed_Prior = rpert(1,0.17,0.45,6,shape = 4) #Reduction due to Hanwashing Stration
Cont_Student<-round(Cont_Student*10^-LogRed_Prior,0)
}
if (Sanitizing_Station == 1){
LogRed_Prior<-Func_Randomize_Sanitizer(Wash_Method = Sanitizer_Method) #Reduction due to hand sanitizer
Cont_Student<-round(Cont_Student*10^-LogRed_Prior,0)
}
Is_Student_ill<-1
if(Is_Student_ill==1){
Vector_Is_Student_ill<-c(Vector_Is_Student_ill,Is_Student_ill)
}
}
#Runing Self assigned Student pathogen contamination
if(Toggle_SelfAssigned_Pathogens==1){
if( k == Student_Pathogen_Day[Student_Pathogen_Count]
&& j == Student_Pathogen_Service[Student_Pathogen_Count]
&& z == Student_Pathogen_No[Student_Pathogen_Count]){
Cont_Student<-do.call(Func_ICont_Student,Inputs_ICont_Student)
print(Cont_Student)
Student_Pathogen_Count<-(Student_Pathogen_Count+1)
if(Student_Pathogen_Count>Number_Student_Pathogens){
Student_Pathogen_Count<-Number_Student_Pathogens
}
}
}
#Running Student Allergen Contamination based on Probability
Cont_Student_Allergen_YN<-ifelse(runif(1)<Pr_Student_Allergen,1,0)
#Self Assigned Contaminations
if(Toggle_SelfAssigned_Allergens==1){
if( k == Student_Allergen_Day[Student_Allergen_Count]
&& j == Student_Allergen_Service[Student_Allergen_Count]
&& z == Student_Allergen_No[Student_Allergen_Count]){
Cont_Student_Allergen_YN <- 1
#print("A student is contaminated with Allergens")
Student_Allergen_Count<-(Student_Allergen_Count+1)
if(Student_Allergen_Count>Number_Student_Allergens){
Student_Allergen_Count<-Number_Student_Allergens
}
}
}
#Setting Working Directory-------------------------------------
#setwd("C:/Users/gareyes3/Documents/GitHub/Share-Table-Milk/R")
#setwd("G:/Share Table QMRA/Share-Table-QMRA/R")
#setwd(getSrcDirectory()[1])
setwd(dirname(rstudioapi::getActiveDocumentContext()$path)) #Set working directory to the path of document
#Opening Libary and Inputs-------------------------------------
source("Util_Library.R")
source("Functions_Full_Analysis.R")
#Inputs and Source Files-------------------------------------
#Inputs
source("Main_Loop.R")
source("Input_Static.R")
source("Input_Functions.R")
source("Util_DFFunctions.R")
source("Util_DFWeekCreation.R")
source("Util_Counter&Lists.R")
#Functions
source("Util_Functions.R")
source("Util_CCFunctions2.R")
source("Util_VisualFunctions.R")
source("Util_Output_Functions.R")
#Inputs and Source Files-------------------------------------
#Inputs
source("Main_Loop.R")
source("Input_Static.R")
source("Input_Functions.R")
source("Util_DFFunctions.R")
source("Util_DFWeekCreation.R")
source("Util_Counter&Lists.R")
#Functions
source("Util_Functions.R")
source("Util_CCFunctions2.R")
source("Util_VisualFunctions.R")
source("Util_Output_Functions.R")
#Running Loop First:-------------------------------------
start_time<-Sys.time()
source("Main_Loops2.R")
View(Pre_Data.Frame)
View(Pre_Data)
View(Fr_Data.Frame)
#Setting Working Directory-------------------------------------
#setwd("C:/Users/gareyes3/Documents/GitHub/Share-Table-Milk/R")
#setwd("G:/Share Table QMRA/Share-Table-QMRA/R")
#setwd(getSrcDirectory()[1])
setwd(dirname(rstudioapi::getActiveDocumentContext()$path)) #Set working directory to the path of document
#Opening Libary and Inputs-------------------------------------
source("Util_Library.R")
source("Functions_Full_Analysis.R")
#Inputs and Source Files-------------------------------------
#Inputs
source("Main_Loop.R")
source("Input_Static.R")
source("Input_Functions.R")
source("Util_DFFunctions.R")
source("Util_DFWeekCreation.R")
source("Util_Counter&Lists.R")
#Functions
source("Util_Functions.R")
source("Util_CCFunctions2.R")
source("Util_VisualFunctions.R")
source("Util_Output_Functions.R")
#Running Loop First:-------------------------------------
start_time<-Sys.time()
source("Main_Loops2.R")
#Setting Working Directory-------------------------------------
#setwd("C:/Users/gareyes3/Documents/GitHub/Share-Table-Milk/R")
#setwd("G:/Share Table QMRA/Share-Table-QMRA/R")
#setwd(getSrcDirectory()[1])
setwd(dirname(rstudioapi::getActiveDocumentContext()$path)) #Set working directory to the path of document
#Opening Libary and Inputs-------------------------------------
source("Util_Library.R")
source("Functions_Full_Analysis.R")
#Inputs and Source Files-------------------------------------
#Inputs
source("Main_Loop.R")
source("Input_Static.R")
source("Input_Functions.R")
source("Util_DFFunctions.R")
source("Util_DFWeekCreation.R")
source("Util_Counter&Lists.R")
#Functions
source("Util_Functions.R")
source("Util_CCFunctions2.R")
source("Util_VisualFunctions.R")
source("Util_Output_Functions.R")
#Running Loop First:-------------------------------------
start_time<-Sys.time()
source("Main_Loops2.R")
View(Fr_Data.Frame)
View(Pre_Data)
func_mainloop_outs<-function(){
if (Sim_Fruit ==1 && Sim_PRE ==0 && Sim_PSS ==0){
Outputs_Student_Loop<-list(Fr_Data.Frame=Fr_Data.Frame) #Fruit on
} else if (Sim_Fruit ==0 && Sim_PRE ==1 && Sim_PSS ==0){
Outputs_Student_Loop<-list(Pre_Data.Frame=Pre_Data.Frame) #PRE on
} else if (Sim_Fruit ==0 && Sim_PRE ==0 && Sim_PSS ==1){
Outputs_Student_Loop<-list(Pss_Data.Frame=Pss_Data.Frame) #PSS on
} else if (Sim_Fruit ==1 && Sim_PRE ==1 && Sim_PSS ==0){
Outputs_Student_Loop<-list(Fr_Data.Frame=Fr_Data.Frame,Pre_Data.Frame=Pre_Data.Frame) #Fruit and PRE on
} else if (Sim_Fruit ==1 && Sim_PRE ==0 && Sim_PSS ==1){
Outputs_Student_Loop<-list(Fr_Data.Frame=Fr_Data.Frame,Pss_Data.Frame=Pss_Data.Frame) #Fruit and PSS on
} else if (Sim_Fruit ==0 && Sim_PRE ==1 && Sim_PSS ==1){
Outputs_Student_Loop<-list(Fr_Data.Frame=Fr_Data.Frame,Pss_Data.Frame=Pss_Data.Frame) #PRE and PSS on
} else if (Sim_Fruit ==1 && Sim_PRE ==1 && Sim_PSS ==1){
Outputs_Student_Loop<-list(Fr_Data.Frame=Fr_Data.Frame,Pss_Data.Frame=Pss_Data.Frame, Pre_Data.Frame = Pre_Data.Frame) #Fruit, PRE and PSS on
}
return (Outputs_Student_Loop)
}
#Inputs and Source Files-------------------------------------
#Inputs
source("Main_Loop.R")
source("Input_Static.R")
source("Input_Functions.R")
source("Util_DFFunctions.R")
source("Util_DFWeekCreation.R")
source("Util_Counter&Lists.R")
#Functions
source("Util_Functions.R")
source("Util_CCFunctions2.R")
source("Util_VisualFunctions.R")
source("Util_Output_Functions.R")
#Running Loop First:-------------------------------------
start_time<-Sys.time()
source("Main_Loops2.R")
1*10^-4
log10(1)
log10(0.1)
#Setting Working Directory-------------------------------------
#setwd("C:/Users/gareyes3/Documents/GitHub/Share-Table-Milk/R")
#setwd("G:/Share Table QMRA/Share-Table-QMRA/R")
#setwd(getSrcDirectory()[1])
setwd(dirname(rstudioapi::getActiveDocumentContext()$path)) #Set working directory to the path of document
#Opening Libary and Inputs-------------------------------------
source("Util_Library.R")
source("Functions_Full_Analysis.R")
#Inputs and Source Files-------------------------------------
#Inputs
source("Main_Loop.R")
source("Input_Static.R")
source("Input_Functions.R")
source("Util_DFFunctions.R")
source("Util_DFWeekCreation.R")
source("Util_Counter&Lists.R")
#Functions
source("Util_Functions.R")
source("Util_CCFunctions2.R")
source("Util_VisualFunctions.R")
source("Util_Output_Functions.R")
#Running Loop First:-------------------------------------
start_time<-Sys.time()
source("Main_Loops2.R")
#SummaryLisr = List_Sens_Fr
#FoodType= = "Fruit"
#1. Start from here
Individual_Analysis_Fr<-rbind.fill(List_Sens_Pre)
#2. find the dupplicates
#this step filters replicated based on the ID
Individual_Analysis_Fr<-Individual_Analysis_Fr %>%
group_by(ID) %>%
filter(TotServices==max(TotServices))
#3
AnalysysDF<-Individual_Analysis_Fr
library(scales)
library(forcats)
AnalysysDF %>%
count(Location) %>%
arrange(desc(n)) %>%
mutate(Location = fct_reorder(Location, n)) %>%
ggplot(aes(x =Location, y = n/sum(n)*100))+
scale_y_continuous(labels = scales::percent_format(scale = 1) )+
geom_col()+
labs(x = "Final Food Location", y = "Percent of milk items by location", title= "Final Location for milk-Donation happens end of week")+
theme(plot.title = element_text(hjust = 0.5))+
coord_flip()
library(scales)
library(forcats)
AnalysysDF %>%
count(Location) %>%
arrange(desc(n)) %>%
mutate(Location = fct_reorder(Location, n)) %>%
ggplot(aes(x =Location, y = n/sum(n)*100))+
scale_y_continuous(labels = scales::percent_format(scale = 1) )+
geom_col()+
labs(x = "Final Food Location", y = "Percent of milk items by location", title= "Final Location for milk-Donation happens end of week")+
theme(plot.title = element_text(hjust = 0.5))+
coord_flip()
AnalysysDF %>%
ggplot(aes(x = TotTime))+
geom_histogram()+
scale_x_continuous(n.breaks= 10)+
labs(x = "Time in Hours", y = "Count ", title= "Time in system by Item week")+
theme(plot.title = element_text(hjust = 0.5))
AnalysysDF %>%
ggplot(aes(x = SpoilageCon))+
geom_histogram(color="darkblue", fill="lightblue")+
geom_vline(xintercept =7, color= "Red")+
scale_x_continuous(n.breaks= 10)+
labs(x = "Phsychotroph Population Log CFU/ml", y = "Count", title= "Levels per milk carton")+
theme(plot.title = element_text(hjust = 0.5))
AnalysysDF %>%
ggplot(aes(y = SpoilageCon, x= TotTime, color = ConsumedAt))+
geom_point( size =2, fill = "skyblue", shape = 21, alpha = 0.7, fill = "blue")+
geom_hline(yintercept =7, color= "Red")+
facet_wrap(.~Location, scales = "free_x")+
labs(x = "Time in System", y = "Phsychotroph Population Log CFU/ml", title= "Psychotrophic Population vs total time in system, milk Items- Week")+
scale_y_continuous()+
scale_x_log10(n.breaks= 10)+
theme(plot.title = element_text(hjust = 0.5))
AnalysysDF %>%
ggplot(aes(y = SpoilageCon, x= TotTime, color = ConsumedAt))+
geom_point( size =2, fill = "skyblue", shape = 21, alpha = 0.7, fill = "blue")+
geom_hline(yintercept =7, color= "Red")+
facet_wrap(.~Location, scales = "free_x")+
labs(x = "Time in System", y = "Phsychotroph Population Log CFU/ml", title= "Psychotrophic Population vs total time in system, milk Items- Week")+
scale_y_continuous()+
#scale_x_log10(n.breaks= 10)+
theme(plot.title = element_text(hjust = 0.5))
